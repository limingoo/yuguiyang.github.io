<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>于贵洋的博客</title>
  <subtitle>BI、数据分析</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://yuguiyang.github.io/"/>
  <updated>2017-08-29T14:48:43.744Z</updated>
  <id>https://yuguiyang.github.io/</id>
  
  <author>
    <name>于贵洋</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>博客迁移整理中(置顶)</title>
    <link href="https://yuguiyang.github.io/2017/12/31/top/"/>
    <id>https://yuguiyang.github.io/2017/12/31/top/</id>
    <published>2017-12-31T13:59:00.000Z</published>
    <updated>2017-08-29T14:48:43.744Z</updated>
    
    <content type="html"><![CDATA[<p>Hi，欢迎访问我的博客。最近正在迁移文章到这里，不定时更新中，请期待。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Hi，欢迎访问我的博客。最近正在迁移文章到这里，不定时更新中，请期待。&lt;/p&gt;

    
    </summary>
    
      <category term="随笔" scheme="https://yuguiyang.github.io/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="随笔" scheme="https://yuguiyang.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-常用函数</title>
    <link href="https://yuguiyang.github.io/2017/09/10/mysql-handbook-06/"/>
    <id>https://yuguiyang.github.io/2017/09/10/mysql-handbook-06/</id>
    <published>2017-09-10T00:00:00.000Z</published>
    <updated>2017-09-11T05:36:08.290Z</updated>
    
    <content type="html"><![CDATA[<p>MySQL<br>常用函数</p>
<p>这里介绍下，MySQL中常用的函数，函数有太多太多，不一定都需要记住，只需要有个印象，需要的时候去文档中找一下，记住一些常用的就好了</p>
<h2 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h2><h3 id="abs-x"><a href="#abs-x" class="headerlink" title="abs(x)"></a>abs(x)</h3><p>返回x的绝对值<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">abs</span>(<span class="number">-10</span>),<span class="keyword">abs</span>(<span class="number">10</span>)</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-5a4d7d49d66d09b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="abs"></p>
<a id="more"></a>
<h3 id="ceil-x-、ceiling-x"><a href="#ceil-x-、ceiling-x" class="headerlink" title="ceil(x)、ceiling(x)"></a>ceil(x)、ceiling(x)</h3><p>向上取整,比该值大的第一个整数<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">CEIL</span>(<span class="number">9.3</span>),<span class="keyword">CEIL</span>(<span class="number">9.5</span>),<span class="keyword">CEIL</span>(<span class="number">9.6</span>),<span class="keyword">CEIL</span>(<span class="number">-9.5</span>),<span class="keyword">CEIL</span>(<span class="number">-9.1</span>)</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-3106d7b4937de867.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ceil"></p>
<h3 id="floor-x"><a href="#floor-x" class="headerlink" title="floor(x)"></a>floor(x)</h3><p>向下取整，比该值小的第一个整数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">FLOOR</span>(<span class="number">9.3</span>),<span class="keyword">FLOOR</span>(<span class="number">9.5</span>),<span class="keyword">FLOOR</span>(<span class="number">9.6</span>),<span class="keyword">FLOOR</span>(<span class="number">-9.5</span>),<span class="keyword">FLOOR</span>(<span class="number">-9.1</span>)</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-52ccb9f3d6295929.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="floor"></p>
<h3 id="round-x-round-x-y"><a href="#round-x-round-x-y" class="headerlink" title="round(x),round(x,y)"></a>round(x),round(x,y)</h3><p>四舍五入，round(x)，最近的一个整数，round(x,y)，这个y可以指定精度</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">ROUND</span>(<span class="number">9.3</span>),<span class="keyword">ROUND</span>(<span class="number">9.6</span>),<span class="keyword">ROUND</span>(<span class="number">9.378</span>,<span class="number">2</span>),<span class="keyword">ROUND</span>(<span class="number">9.455</span>,<span class="number">2</span>)</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-d46d1e49943ffec7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="round"></p>
<h3 id="rand-rand-x"><a href="#rand-rand-x" class="headerlink" title="rand(),rand(x)"></a>rand(),rand(x)</h3><p>rand() 返回0~1之间的随机数<br>rand(x) 返回0~1之间的随机数，如果x值相等，则返回值相等</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> <span class="keyword">RAND</span>(),<span class="keyword">RAND</span>(),<span class="keyword">RAND</span>(<span class="number">10</span>),<span class="keyword">RAND</span>(<span class="number">10</span>)</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-80978f1eb1fd9dfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="rand"></p>
<h2 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h2><h3 id="获取字符串长度"><a href="#获取字符串长度" class="headerlink" title="获取字符串长度"></a>获取字符串长度</h3><p> length(str)，返回str的长度,这里要注意下中文，占3个长度,这里的长度单位是bytes<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select length('abc'),length('中国'),length('hi中国');</div><div class="line">+<span class="comment">---------------+----------------+------------------+</span></div><div class="line">| length('abc') | length('中国') | length('hi中国') |</div><div class="line">+<span class="comment">---------------+----------------+------------------+</span></div><div class="line">|             3 |              6 |                8 |</div><div class="line">+<span class="comment">---------------+----------------+------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<p> CHAR_LENGTH(str)，返回str的长度，中文和英文一样，占1个字符，这里长度单位是字符<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select char_length('abc'),char_length('中国'),char_length('hi中国');</div><div class="line">+<span class="comment">--------------------+---------------------+-----------------------+</span></div><div class="line">| char_length('abc') | char_length('中国') | char_length('hi中国') |</div><div class="line">+<span class="comment">--------------------+---------------------+-----------------------+</span></div><div class="line">|                  3 |                   2 |                     4 |</div><div class="line">+<span class="comment">--------------------+---------------------+-----------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<h3 id="字符串拼接"><a href="#字符串拼接" class="headerlink" title="字符串拼接"></a>字符串拼接</h3><p>CONCAT(str1,str2,…)，将str1，str2拼接在一起<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">mysql&gt; select concat('h','e','gogo','中国');</div><div class="line">+<span class="comment">-------------------------------+</span></div><div class="line">| concat('h','e','gogo','中国') |</div><div class="line">+<span class="comment">-------------------------------+</span></div><div class="line">| hegogo中国                    |</div><div class="line">+<span class="comment">-------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<p>这里要注意下NULL，如果其中有参数为NULL，则结果为NULL<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select concat('h','e','gogo',NULL,'中国');</div><div class="line">+<span class="comment">------------------------------------+</span></div><div class="line">| concat('h','e','gogo',NULL,'中国') |</div><div class="line">+<span class="comment">------------------------------------+</span></div><div class="line">| NULL                               |</div><div class="line">+<span class="comment">------------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<p>CONCAT_WS(separator,str1,str2,…)，使用指定的separator进行拼接<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select concat_ws('^','e','gogo',NULL,'中国');</div><div class="line">+<span class="comment">---------------------------------------+</span></div><div class="line">| concat_ws('^','e','gogo',NULL,'中国') |</div><div class="line">+<span class="comment">---------------------------------------+</span></div><div class="line">| e^gogo^中国                           |</div><div class="line">+<span class="comment">---------------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<p>这里是如果有NULL，对结果是没有影响的，会直接忽略NULL值</p>
<h3 id="剔除空格或指定字符"><a href="#剔除空格或指定字符" class="headerlink" title="剔除空格或指定字符"></a>剔除空格或指定字符</h3><p>剔除字符串左右的空格<br>ltrim(str),剔除左侧空格<br>rtrim(str),剔除右侧空格<br>TRIM([{BOTH | LEADING | TRAILING} [remstr] FROM] str), TRIM([remstr FROM] str)<br>trim可以使用参数来控制剔除空格或者是指定的remstr，默认是空格<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select concat(ltrim('   hi   '),'oo'),concat(rtrim('   hi   '),'oo'),concat(trim('   hi   '),'oo');</div><div class="line">+<span class="comment">--------------------------------+--------------------------------+-------------------------------+</span></div><div class="line">| concat(ltrim('   hi   '),'oo') | concat(rtrim('   hi   '),'oo') | concat(trim('   hi   '),'oo') |</div><div class="line">+<span class="comment">--------------------------------+--------------------------------+-------------------------------+</span></div><div class="line">| hi   oo                        |    hioo                        | hioo                          |</div><div class="line">+<span class="comment">--------------------------------+--------------------------------+-------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">select</span> <span class="keyword">trim</span>(<span class="string">'a'</span> <span class="keyword">from</span> <span class="string">'aabbbccaa'</span>),<span class="keyword">trim</span>(<span class="keyword">leading</span> <span class="string">'a'</span> <span class="keyword">from</span> <span class="string">'aabbbccaa'</span>),<span class="keyword">trim</span>(trailing <span class="string">'a'</span> <span class="keyword">from</span> <span class="string">'aabbbccaa'</span>);</div><div class="line">+<span class="comment">----------------------------+------------------------------------+-------------------------------------+</span></div><div class="line">| trim('a' from 'aabbbccaa') | trim(leading 'a' from 'aabbbccaa') | trim(trailing 'a' from 'aabbbccaa') |</div><div class="line">+<span class="comment">----------------------------+------------------------------------+-------------------------------------+</span></div><div class="line">| bbbcc                      | bbbccaa                            | aabbbcc                             |</div><div class="line">+<span class="comment">----------------------------+------------------------------------+-------------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<h3 id="字符串填充"><a href="#字符串填充" class="headerlink" title="字符串填充"></a>字符串填充</h3><p>LPAD(str,len,padstr)，左侧填充<br>RPAD(str,len,padstr)，右侧填充<br>len是指定str的长度，如果不够，则使用padstr填充，如果超了，则进行截取<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select lpad('hi',6,'@'),lpad('higogo',4,'@'),rpad('hi',6,'@'),rpad('higogo',4,'@');</div><div class="line">+<span class="comment">------------------+----------------------+------------------+----------------------+</span></div><div class="line">| lpad('hi',6,'@') | lpad('higogo',4,'@') | rpad('hi',6,'@') | rpad('higogo',4,'@') |</div><div class="line">+<span class="comment">------------------+----------------------+------------------+----------------------+</span></div><div class="line">| @@@@hi           | higo                 | hi@@@@           | higo                 |</div><div class="line">+<span class="comment">------------------+----------------------+------------------+----------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<h3 id="字符串截取"><a href="#字符串截取" class="headerlink" title="字符串截取"></a>字符串截取</h3><p>LEFT(str,len)，从左侧开始截取len个字符<br>RIGHT(str,len)，从右侧截取len个字符<br>SUBSTR(str,pos), SUBSTR(str FROM pos), SUBSTR(str,pos,len), SUBSTR(str FROM pos FOR len)，从指定pos开始截取len个字符<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select left('hello',1),left('hello',3),right('hello',3);</div><div class="line">+<span class="comment">-----------------+-----------------+------------------+</span></div><div class="line">| left('hello',1) | left('hello',3) | right('hello',3) |</div><div class="line">+<span class="comment">-----------------+-----------------+------------------+</span></div><div class="line">| h               | hel             | llo              |</div><div class="line">+<span class="comment">-----------------+-----------------+------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">select</span> <span class="keyword">substr</span>(<span class="string">'hello'</span>,<span class="number">1</span>),<span class="keyword">substr</span>(<span class="string">'hello'</span>,<span class="number">2</span>),<span class="keyword">substr</span>(<span class="string">'hello'</span> <span class="keyword">from</span> <span class="number">2</span>);</div><div class="line">+<span class="comment">-------------------+-------------------+------------------------+</span></div><div class="line">| substr('hello',1) | substr('hello',2) | substr('hello' from 2) |</div><div class="line">+<span class="comment">-------------------+-------------------+------------------------+</span></div><div class="line">| hello             | ello              | ello                   |</div><div class="line">+<span class="comment">-------------------+-------------------+------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">select</span> <span class="keyword">substr</span>(<span class="string">'hello'</span>,<span class="number">1</span>,<span class="number">3</span>),<span class="keyword">substr</span>(<span class="string">'hello'</span>,<span class="number">2</span>,<span class="number">3</span>),<span class="keyword">substr</span>(<span class="string">'hello'</span> <span class="keyword">from</span> <span class="number">2</span> <span class="keyword">for</span> <span class="number">2</span>);</div><div class="line">+<span class="comment">---------------------+---------------------+------------------------------+</span></div><div class="line">| substr('hello',1,3) | substr('hello',2,3) | substr('hello' from 2 for 2) |</div><div class="line">+<span class="comment">---------------------+---------------------+------------------------------+</span></div><div class="line">| hel                 | ell                 | el                           |</div><div class="line">+<span class="comment">---------------------+---------------------+------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<h3 id="大小写转换"><a href="#大小写转换" class="headerlink" title="大小写转换"></a>大小写转换</h3><p>LOWER(str) LCASE(str)，将str转为小写<br>UPPER(str) UCASE(str)，将str转为大写<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select lower('AppLE'),lcase('AppLE'),upper('AppLE'),ucase('AppLE');</div><div class="line">+<span class="comment">----------------+----------------+----------------+----------------+</span></div><div class="line">| lower('AppLE') | lcase('AppLE') | upper('AppLE') | ucase('AppLE') |</div><div class="line">+<span class="comment">----------------+----------------+----------------+----------------+</span></div><div class="line">| apple          | apple          | APPLE          | APPLE          |</div><div class="line">+<span class="comment">----------------+----------------+----------------+----------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<h3 id="更多字符串函数"><a href="#更多字符串函数" class="headerlink" title="更多字符串函数"></a>更多字符串函数</h3><p>参考官网： <a href="https://dev.mysql.com/doc/refman/5.7/en/string-functions.html" target="_blank" rel="external">https://dev.mysql.com/doc/refman/5.7/en/string-functions.html</a></p>
<h2 id="日期和函数"><a href="#日期和函数" class="headerlink" title="日期和函数"></a>日期和函数</h2><h3 id="获取当前日期、时间"><a href="#获取当前日期、时间" class="headerlink" title="获取当前日期、时间"></a>获取当前日期、时间</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">CURRENT_DATE</span>,<span class="keyword">CURRENT_DATE</span>(),<span class="keyword">CURRENT_TIME</span>,<span class="keyword">CURRENT_TIME</span>(),<span class="keyword">CURRENT_TIMESTAMP</span>(),<span class="keyword">NOW</span>()</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-d02a125fbe334c51.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="当前日期、时间"></p>
<h3 id="时间戳相关函数"><a href="#时间戳相关函数" class="headerlink" title="时间戳相关函数"></a>时间戳相关函数</h3><p>UNIX_TIMESTAMP() 返回当前时间的时间戳，<br>UNIX_TIMESTAMP(x) 返回指定日期的时间戳<br>FROM_UNIXTIME(x) 将时间戳转为日期<br>FROM_UNIXTIME(x,y) 将时间戳转为指定格式的日期</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select UNIX_TIMESTAMP(),UNIX_TIMESTAMP('2017-09-10');</div><div class="line">+<span class="comment">------------------+------------------------------+</span></div><div class="line">| UNIX_TIMESTAMP() | UNIX_TIMESTAMP('2017-09-10') |</div><div class="line">+<span class="comment">------------------+------------------------------+</span></div><div class="line">|       1505096065 |                   1504972800 |</div><div class="line">+<span class="comment">------------------+------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">select</span> FROM_UNIXTIME(<span class="number">1505096033</span>),FROM_UNIXTIME(<span class="number">1504972800</span>),FROM_UNIXTIME(<span class="number">1505096033</span>,<span class="string">'%Y-%m-%d'</span>);</div><div class="line">+<span class="comment">---------------------------+---------------------------+--------------------------------------+</span></div><div class="line">| FROM_UNIXTIME(1505096033) | FROM_UNIXTIME(1504972800) | FROM_UNIXTIME(1505096033,'%Y-%m-%d') |</div><div class="line">+<span class="comment">---------------------------+---------------------------+--------------------------------------+</span></div><div class="line">| 2017-09-11 10:13:53       | 2017-09-10 00:00:00       | 2017-09-11                           |</div><div class="line">+<span class="comment">---------------------------+---------------------------+--------------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
<h3 id="extract"><a href="#extract" class="headerlink" title="extract"></a>extract</h3><p>EXTRACT(unit FROM date)<br>返回日期/时间的单独部分，比如年、月、日、小时、分钟等等<br>date 参数是合法的日期表达式。unit 参数可以是下列的值：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-9db81fd5fd206620.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="extract"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select extract(YEAR FROM NOW()),extract(MONTH from now()),extract(HOUR from now());</div><div class="line">+<span class="comment">--------------------------+---------------------------+--------------------------+</span></div><div class="line">| extract(YEAR FROM NOW()) | extract(MONTH from now()) | extract(HOUR from now()) |</div><div class="line">+<span class="comment">--------------------------+---------------------------+--------------------------+</span></div><div class="line">|                     2017 |                         9 |                       10 |</div><div class="line">+<span class="comment">--------------------------+---------------------------+--------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
<h3 id="datediff、timediff、timestampdiff"><a href="#datediff、timediff、timestampdiff" class="headerlink" title="datediff、timediff、timestampdiff"></a>datediff、timediff、timestampdiff</h3><p>datediff(<em>expr1</em>,<em>expr2</em>),获取2个日期相差的天数<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select datediff('2017-09-11 10:00:00','2017-09-08 00:00:00');</div><div class="line">+<span class="comment">-------------------------------------------------------+</span></div><div class="line">| datediff('2017-09-11 10:00:00','2017-09-08 00:00:00') |</div><div class="line">+<span class="comment">-------------------------------------------------------+</span></div><div class="line">|                                                     3 |</div><div class="line">+<span class="comment">-------------------------------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>TIMEDIFF(<em>expr1</em>,<em>expr2</em>)，返回expr1-expr2的时间差<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select timediff('2017-09-11 10:00:00','2017-09-08 00:00:00');</div><div class="line">+<span class="comment">-------------------------------------------------------+</span></div><div class="line">| timediff('2017-09-11 10:00:00','2017-09-08 00:00:00') |</div><div class="line">+<span class="comment">-------------------------------------------------------+</span></div><div class="line">| 82:00:00                                              |</div><div class="line">+<span class="comment">-------------------------------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p>TIMESTAMPDIFF(unit,datetime_expr1,datetime_expr2)<br>返回指定unit的datetime_expr2 − datetime_expr1时间差<br>unit可以是MICROSECOND (microseconds), SECOND, MINUTE, HOUR, DAY, WEEK, MONTH, QUARTER, or YEAR.<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select timestampdiff(DAY,'2017-09-11 10:00:00','2017-09-08 00:00:00');</div><div class="line">+<span class="comment">----------------------------------------------------------------+</span></div><div class="line">| timestampdiff(DAY,'2017-09-11 10:00:00','2017-09-08 00:00:00') |</div><div class="line">+<span class="comment">----------------------------------------------------------------+</span></div><div class="line">|                                                             -3 |</div><div class="line">+<span class="comment">----------------------------------------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt; <span class="keyword">select</span> <span class="keyword">timestampdiff</span>(<span class="keyword">HOUR</span>,<span class="string">'2017-09-11 10:00:00'</span>,<span class="string">'2017-09-08 00:00:00'</span>);</div><div class="line">+<span class="comment">-----------------------------------------------------------------+</span></div><div class="line">| timestampdiff(HOUR,'2017-09-11 10:00:00','2017-09-08 00:00:00') |</div><div class="line">+<span class="comment">-----------------------------------------------------------------+</span></div><div class="line">|                                                             -82 |</div><div class="line">+<span class="comment">-----------------------------------------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="时间加减函数"><a href="#时间加减函数" class="headerlink" title="时间加减函数"></a>时间加减函数</h3><p>对日期进行加减操作，有很多方法可以使用，最简单的是直接使用interval<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select now(),now() + interval 3 DAY,now()+interval 1 Hour;</div><div class="line">+<span class="comment">---------------------+------------------------+-----------------------+</span></div><div class="line">| now()               | now() + interval 3 DAY | now()+interval 1 Hour |</div><div class="line">+<span class="comment">---------------------+------------------------+-----------------------+</span></div><div class="line">| 2017-09-11 10:57:18 | 2017-09-14 10:57:18    | 2017-09-11 11:57:18   |</div><div class="line">+<span class="comment">---------------------+------------------------+-----------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<p>当然也可使用提供的函数</p>
<blockquote>
<p>ADDDATE(date,INTERVAL expr unit), ADDDATE(expr,days)<br>DATE_ADD(date,INTERVAL expr unit), DATE_SUB(date,INTERVAL expr unit)</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-7aa2e3a9f08f3d65.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="日期加减"><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select now(),date_add(now(),interval 1 Day),adddate(now(),interval 3 Hour);</div><div class="line">+<span class="comment">---------------------+--------------------------------+--------------------------------+</span></div><div class="line">| now()               | date_add(now(),interval 1 Day) | adddate(now(),interval 3 Hour) |</div><div class="line">+<span class="comment">---------------------+--------------------------------+--------------------------------+</span></div><div class="line">| 2017-09-11 10:59:09 | 2017-09-12 10:59:09            | 2017-09-11 13:59:09            |</div><div class="line">+<span class="comment">---------------------+--------------------------------+--------------------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div></pre></td></tr></table></figure></p>
<h3 id="更多日期、时间函数"><a href="#更多日期、时间函数" class="headerlink" title="更多日期、时间函数"></a>更多日期、时间函数</h3><p>参考官方介绍: <a href="https:
//dev.mysql.com/doc/refman/5.7/en/date-and-time-functions.html" target="_blank" rel="external">https://dev.mysql.com/doc/refman/5.7/en/date-and-time-functions.html</a></p>
<h2 id="条件判断函数"><a href="#条件判断函数" class="headerlink" title="条件判断函数"></a>条件判断函数</h2><h3 id="if"><a href="#if" class="headerlink" title="if"></a>if</h3><blockquote>
<p>if(expr,v1,v2)<br>如果expr为真，则返回v1，为假，则返回v2<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select if(1&gt;0,'ok','no'),if(1=0,'ok','no');</div><div class="line">+<span class="comment">-------------------+-------------------+</span></div><div class="line">| if(1&gt;0,'ok','no') | if(1=0,'ok','no') |</div><div class="line">+<span class="comment">-------------------+-------------------+</span></div><div class="line">| ok                | no                |</div><div class="line">+<span class="comment">-------------------+-------------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="ifnull"><a href="#ifnull" class="headerlink" title="ifnull"></a>ifnull</h3><blockquote>
<p>ifnull(v1,v2)<br>如果v1的值为null，则返回v2，如果v1不为null，则返回v1<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select ifnull(99,20),ifnull(NULL,99);</div><div class="line">+<span class="comment">---------------+-----------------+</span></div><div class="line">| ifnull(99,20) | ifnull(NULL,99) |</div><div class="line">+<span class="comment">---------------+-----------------+</span></div><div class="line">|            99 |              99 |</div><div class="line">+<span class="comment">---------------+-----------------+</span></div><div class="line">1 row in <span class="keyword">set</span></div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="case-when"><a href="#case-when" class="headerlink" title="case when"></a>case when</h3><blockquote>
<p>这里可以根据多个条件来判断，在不同的情况下，返回不同的值</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">    s_id,s_name,s_gender,</div><div class="line">    <span class="keyword">case</span> </div><div class="line">        <span class="keyword">when</span> s_gender=<span class="number">0</span> <span class="keyword">then</span> <span class="string">'男'</span> </div><div class="line">        <span class="keyword">when</span> s_gender=<span class="number">1</span> <span class="keyword">then</span> <span class="string">'女'</span> </div><div class="line">    <span class="keyword">end</span> gender,</div><div class="line">    s_birthday,</div><div class="line">    s_hobby,</div><div class="line">    c_id</div><div class="line"><span class="keyword">from</span> </div><div class="line">    t_student</div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-019524cc95e1a303.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="case when"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MySQL&lt;br&gt;常用函数&lt;/p&gt;
&lt;p&gt;这里介绍下，MySQL中常用的函数，函数有太多太多，不一定都需要记住，只需要有个印象，需要的时候去文档中找一下，记住一些常用的就好了&lt;/p&gt;
&lt;h2 id=&quot;数学函数&quot;&gt;&lt;a href=&quot;#数学函数&quot; class=&quot;headerlink&quot; title=&quot;数学函数&quot;&gt;&lt;/a&gt;数学函数&lt;/h2&gt;&lt;h3 id=&quot;abs-x&quot;&gt;&lt;a href=&quot;#abs-x&quot; class=&quot;headerlink&quot; title=&quot;abs(x)&quot;&gt;&lt;/a&gt;abs(x)&lt;/h3&gt;&lt;p&gt;返回x的绝对值&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;abs&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;-10&lt;/span&gt;),&lt;span class=&quot;keyword&quot;&gt;abs&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/76024-5a4d7d49d66d09b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;abs&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/categories/MySQL/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-分组排序</title>
    <link href="https://yuguiyang.github.io/2017/09/09/mysql-handbook-05/"/>
    <id>https://yuguiyang.github.io/2017/09/09/mysql-handbook-05/</id>
    <published>2017-09-09T04:00:00.000Z</published>
    <updated>2017-09-11T05:36:59.342Z</updated>
    
    <content type="html"><![CDATA[<p>MySQL<br>分组排序</p>
<p>使用过其他数据库的同学，一定知道那些好用的开窗函数，像什么rank() over(),sum() over() 等等，实现一些功能的时候很好用，但是呢，MySQL中并没有这些函数，那怎样实现这些功能呢？我们可以使用MySQL中的变量来实现这个功能。</p>
<p>我们先来看第一个类型的问题，关于排序的问题</p>
<h2 id="排名"><a href="#排名" class="headerlink" title="排名"></a>排名</h2><p>就是按照指定的字段，给每一条记录分配一个行号（序号），作为他的排名<br>在postgresql中可以使用像rank() over()这样的函数<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">    course_name,</div><div class="line">    s_id,</div><div class="line">    score,</div><div class="line">    <span class="keyword">rank</span>() <span class="keyword">over</span>(<span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span>) rank_score</div><div class="line"><span class="keyword">from</span> </div><div class="line">    t_score</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-05-02.png-blog.photo" alt="mysql-handbook-05-02"></p>
<a id="more"></a>
<p>但在MySQL中，就没这么方便了，我们需要使用变量，来模拟实现<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">    course_name,</div><div class="line">    s_id,</div><div class="line">    score,</div><div class="line">    <span class="comment">-- 根据排序规则，每条记录增加1</span></div><div class="line">    @rn:=@rn+<span class="number">1</span> <span class="keyword">as</span> rank_score</div><div class="line">    <span class="comment">-- 初始化变量@rn，从0开始</span></div><div class="line"><span class="keyword">from</span> t_score <span class="keyword">cross</span> <span class="keyword">join</span> (<span class="keyword">select</span> @rn:=<span class="number">0</span>) x</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span></div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-05-03.png-blog.photo" alt="mysql-handbook-05-03"></p>
<p>细心的同学，会发现，上面的排名会有些差别，以前2条记录为例，因为都是87，所以postgresql中排名都是1，而在MySQL中呢，依然是自增，一个1，一个2，那我们是否能让他也是2个1并列呢？</p>
<p>当然可以，我们改一下SQL<br>只要我们判断一下，当前记录的score和上一条记录的score是不是一样就可以了，那怎样才能获取上一条记录的score呢？就是增加一个变量来记录上一条记录的score<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">    course_name,</div><div class="line">    s_id,</div><div class="line">    score,</div><div class="line">    @pre pre_score,</div><div class="line">    <span class="comment">-- 判断当前score是否和上一条记录的score相等，</span></div><div class="line">    <span class="comment">-- 如果相等则使用和上一条一样的排名</span></div><div class="line">    <span class="keyword">if</span>(@pre=score ,@rn:=@rn,@rn:=@rn+<span class="number">1</span>) <span class="keyword">as</span> rank_score,</div><div class="line">    @pre:=score cur_score</div><div class="line">    <span class="comment">-- 使用pre来保存上一条记录的score</span></div><div class="line"><span class="keyword">from</span> t_score <span class="keyword">cross</span> <span class="keyword">join</span> (<span class="keyword">select</span> @rn:=<span class="number">0</span>,@pre:=<span class="literal">null</span>) x</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span></div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-05-04.png-blog.photo" alt="mysql-handbook-05-04"></p>
<p>上面的排序还是有点儿问题，比如有2个第1之后，依然从第2开始，那我们能不能跳过直接从3开始呢？</p>
<p>我们回想下，最开始他的排名其实就是3，只是我们上边把它变成了2，那我们再有一个和之前一样的变量就够了。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">    course_name,</div><div class="line">    s_id,</div><div class="line">    score,</div><div class="line">    @pre pre_score,</div><div class="line">    @rn_1:=@rn_1+<span class="number">1</span> rank_score_1,</div><div class="line">    <span class="keyword">if</span>(@pre=score ,@rn:=@rn,@rn:=@rn_1) <span class="keyword">as</span> rank_score,</div><div class="line">    @pre:=score cur_score</div><div class="line">    </div><div class="line"><span class="keyword">from</span> t_score <span class="keyword">cross</span> <span class="keyword">join</span> (<span class="keyword">select</span> @rn:=<span class="number">0</span>,@pre:=<span class="literal">null</span>,@rn_1:=<span class="number">0</span>) x</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span></div></pre></td></tr></table></figure>
<p>我们使用@rn_1来正常记录排名，当当前记录和上一条记录的score不一样时，我们使用@rn_1的排名信息。</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-05-05.png-blog.photo" alt="mysql-handbook-05-05"></p>
<h2 id="分组排序"><a href="#分组排序" class="headerlink" title="分组排序"></a>分组排序</h2><p>就是给每个分组中的数据，分别进行排名<br>如果有类似rank() over()的函数<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 在postgresql中</span></div><div class="line"><span class="keyword">select</span> </div><div class="line">    course_name,</div><div class="line">    s_id,</div><div class="line">    score,</div><div class="line">    <span class="keyword">rank</span>() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> course_name <span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span>) rank_score</div><div class="line"><span class="keyword">from</span> </div><div class="line">    t_score</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-05-01.png-blog.photo" alt="mysql-handbook-05-01"></p>
<p>但在MySQL中，就没这么方便了，我们需要使用变量，来模拟实现<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure></p>
<blockquote>
<p>先到这，明天接着写</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MySQL&lt;br&gt;分组排序&lt;/p&gt;
&lt;p&gt;使用过其他数据库的同学，一定知道那些好用的开窗函数，像什么rank() over(),sum() over() 等等，实现一些功能的时候很好用，但是呢，MySQL中并没有这些函数，那怎样实现这些功能呢？我们可以使用MySQL中的变量来实现这个功能。&lt;/p&gt;
&lt;p&gt;我们先来看第一个类型的问题，关于排序的问题&lt;/p&gt;
&lt;h2 id=&quot;排名&quot;&gt;&lt;a href=&quot;#排名&quot; class=&quot;headerlink&quot; title=&quot;排名&quot;&gt;&lt;/a&gt;排名&lt;/h2&gt;&lt;p&gt;就是按照指定的字段，给每一条记录分配一个行号（序号），作为他的排名&lt;br&gt;在postgresql中可以使用像rank() over()这样的函数&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    course_name,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    s_id,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    score,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;rank&lt;/span&gt;() &lt;span class=&quot;keyword&quot;&gt;over&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; score &lt;span class=&quot;keyword&quot;&gt;desc&lt;/span&gt;) rank_score&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; &lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    t_score&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-05-02.png-blog.photo&quot; alt=&quot;mysql-handbook-05-02&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/categories/MySQL/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-regexp</title>
    <link href="https://yuguiyang.github.io/2017/09/09/mysql-handbook-04/"/>
    <id>https://yuguiyang.github.io/2017/09/09/mysql-handbook-04/</id>
    <published>2017-09-09T04:00:00.000Z</published>
    <updated>2017-09-09T15:44:03.148Z</updated>
    
    <content type="html"><![CDATA[<p>MySQL<br>正则表达式</p>
<p>在前面，我们了解了like的使用，它可以做一些简单的匹配</p>
<blockquote>
<p>在like中，我们使用%来代替任意个或多个字符，_表示任意单个字符</p>
</blockquote>
<p>但在实际的应用场景中，我们可能还会需要更强大的匹配方式，比如“正则表达式”，这就需要使用regexp。</p>
<p>常用的正则表达式，更多的内容，大家可以百度下<br><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-04-01.png-blog.photo" alt="mysql-handbook-04-01"></p>
<a id="more"></a>
<p>我们就以前面的t_student表为例</p>
<h2 id="查询学生姓路或乔的学生信息"><a href="#查询学生姓路或乔的学生信息" class="headerlink" title="查询学生姓路或乔的学生信息"></a>查询学生姓路或乔的学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- like </span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_name <span class="keyword">like</span> <span class="string">'路%'</span> <span class="keyword">or</span> s_name <span class="keyword">like</span> <span class="string">'乔%'</span></div><div class="line"></div><div class="line"><span class="comment">-- regexp</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_name regexp <span class="string">'^(路|乔)'</span></div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-04-02.png-blog.photo" alt="mysql-handbook-04-02"></p>
<h2 id="查询名字是以美结尾的学生信息"><a href="#查询名字是以美结尾的学生信息" class="headerlink" title="查询名字是以美结尾的学生信息"></a>查询名字是以美结尾的学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_name regexp <span class="string">'美$'</span></div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-04-03.png-blog.photo" alt="mysql-handbook-04-03"></p>
<h2 id="查询学生爱好中，有吃肉的学生信息"><a href="#查询学生爱好中，有吃肉的学生信息" class="headerlink" title="查询学生爱好中，有吃肉的学生信息"></a>查询学生爱好中，有吃肉的学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_hobby regexp <span class="string">'吃肉'</span></div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-04-04.png-blog.photo" alt="mysql-handbook-04-04"></p>
<h2 id="查询学生姓乔或者名字中有美字的学生信息"><a href="#查询学生姓乔或者名字中有美字的学生信息" class="headerlink" title="查询学生姓乔或者名字中有美字的学生信息"></a>查询学生姓乔或者名字中有美字的学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_name regexp <span class="string">'(^乔)|美'</span></div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-04-05.png-blog.photo" alt="mysql-handbook-04-05"></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>这里先整理这几个简单的例子，后续会再补充。</p>
<p>可以参考官方的文档练习：<a href="https://dev.mysql.com/doc/refman/5.7/en/regexp.html" target="_blank" rel="external">https://dev.mysql.com/doc/refman/5.7/en/regexp.html</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MySQL&lt;br&gt;正则表达式&lt;/p&gt;
&lt;p&gt;在前面，我们了解了like的使用，它可以做一些简单的匹配&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在like中，我们使用%来代替任意个或多个字符，_表示任意单个字符&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;但在实际的应用场景中，我们可能还会需要更强大的匹配方式，比如“正则表达式”，这就需要使用regexp。&lt;/p&gt;
&lt;p&gt;常用的正则表达式，更多的内容，大家可以百度下&lt;br&gt;&lt;img src=&quot;http://7xl61k.com1.z0.glb.clouddn.com/mysql-handbook-04-01.png-blog.photo&quot; alt=&quot;mysql-handbook-04-01&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/categories/MySQL/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>SQL笔试题-MySQL练习题</title>
    <link href="https://yuguiyang.github.io/2017/09/09/data-analyst-interview-sql-04/"/>
    <id>https://yuguiyang.github.io/2017/09/09/data-analyst-interview-sql-04/</id>
    <published>2017-09-09T03:00:00.000Z</published>
    <updated>2017-09-09T14:49:17.589Z</updated>
    
    <content type="html"><![CDATA[<p>SQL笔试题</p>
<blockquote>
<p>下面的SQL基于MySQL</p>
</blockquote>
<p>下面整理些MySQL学习过程中，基本的练习题，题目来源于网上及个人总结。</p>
<h2 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_student(</div><div class="line">	s_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'学生ID'</span>,</div><div class="line">	s_name <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">comment</span> <span class="string">'学生姓名'</span>,</div><div class="line">	s_gender <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'学生性别 0-男,1-女'</span>,</div><div class="line">	s_birthday <span class="built_in">date</span> <span class="keyword">comment</span> <span class="string">'出生日期'</span>,</div><div class="line">	s_hobby <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">comment</span> <span class="string">'爱好'</span>,</div><div class="line">	c_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'班级ID'</span></div><div class="line">) <span class="keyword">comment</span> <span class="string">'学生表'</span>;</div><div class="line"></div><div class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_class(</div><div class="line">	c_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'班级ID'</span>,</div><div class="line">	c_name <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">comment</span> <span class="string">'班级名称'</span></div><div class="line">) <span class="keyword">comment</span> <span class="string">'班级表'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_score(</div><div class="line">	sc_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'成绩ID'</span>,</div><div class="line">	s_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'学生ID'</span>,</div><div class="line">	course_name <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">comment</span> <span class="string">'课程名称'</span>,</div><div class="line">	score <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">comment</span> <span class="string">'成绩'</span></div><div class="line">	</div><div class="line">) <span class="keyword">comment</span> <span class="string">'成绩表'</span>;</div><div class="line"></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">901</span>,<span class="string">'一班'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">902</span>,<span class="string">'二班'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">903</span>,<span class="string">'三班'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">905</span>,<span class="string">'五班'</span>);</div><div class="line"></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">101</span>,<span class="string">'路飞'</span>,<span class="number">0</span>,<span class="string">'1990-01-26'</span>,<span class="string">'吃肉,睡觉'</span>,<span class="number">901</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">102</span>,<span class="string">'娜美'</span>,<span class="number">1</span>,<span class="string">'1995-10-05'</span>,<span class="string">'足球,篮球'</span>,<span class="number">901</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">103</span>,<span class="string">'乔巴'</span>,<span class="number">0</span>,<span class="string">'1992-08-11'</span>,<span class="string">'唱歌,吃肉'</span>,<span class="number">901</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">104</span>,<span class="string">'鸣人'</span>,<span class="number">0</span>,<span class="string">'1991-03-29'</span>,<span class="string">'拉面,忍术'</span>,<span class="number">901</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">105</span>,<span class="string">'卡卡西'</span>,<span class="number">1</span>,<span class="string">'1989-05-10'</span>,<span class="string">'看书,吃肉'</span>,<span class="number">902</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">106</span>,<span class="string">'乌索普'</span>,<span class="number">1</span>,<span class="string">'1988-02-02'</span>,<span class="string">'跳舞,篮球'</span>,<span class="number">902</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">107</span>,<span class="string">'乔峰'</span>,<span class="number">0</span>,<span class="string">'1990-12-12'</span>,<span class="string">'跑步,羽毛球'</span>,<span class="number">902</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">108</span>,<span class="string">'段誉'</span>,<span class="number">0</span>,<span class="string">'1990-12-13'</span>,<span class="string">'吃肉,加班'</span>,<span class="number">903</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">109</span>,<span class="string">'虚竹'</span>,<span class="number">1</span>,<span class="string">'1991-01-22'</span>,<span class="string">'看电影,旅行'</span>,<span class="number">903</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">110</span>,<span class="string">'杨过'</span>,<span class="number">0</span>,<span class="string">'2000-03-04'</span>,<span class="string">'旅行'</span>,<span class="number">903</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">111</span>,<span class="string">'令狐冲'</span>,<span class="number">0</span>,<span class="string">'1997-03-04'</span>,<span class="string">'喝酒'</span>,<span class="number">904</span>);</div><div class="line"></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">101</span>,<span class="string">'数学'</span>,<span class="number">39</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">102</span>,<span class="string">'数学'</span>,<span class="number">20</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">103</span>,<span class="string">'数学'</span>,<span class="number">54</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">104</span>,<span class="string">'数学'</span>,<span class="number">38</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">5</span>,<span class="number">105</span>,<span class="string">'数学'</span>,<span class="number">70</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">6</span>,<span class="number">106</span>,<span class="string">'数学'</span>,<span class="number">15</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">7</span>,<span class="number">107</span>,<span class="string">'数学'</span>,<span class="number">75</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">8</span>,<span class="number">108</span>,<span class="string">'数学'</span>,<span class="number">84</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">9</span>,<span class="number">109</span>,<span class="string">'数学'</span>,<span class="number">87</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">10</span>,<span class="number">110</span>,<span class="string">'数学'</span>,<span class="number">67</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">11</span>,<span class="number">101</span>,<span class="string">'语文'</span>,<span class="number">73</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">12</span>,<span class="number">102</span>,<span class="string">'语文'</span>,<span class="number">71</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">13</span>,<span class="number">103</span>,<span class="string">'语文'</span>,<span class="number">82</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">14</span>,<span class="number">104</span>,<span class="string">'语文'</span>,<span class="number">83</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">15</span>,<span class="number">105</span>,<span class="string">'语文'</span>,<span class="number">36</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">16</span>,<span class="number">106</span>,<span class="string">'语文'</span>,<span class="number">87</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">17</span>,<span class="number">107</span>,<span class="string">'语文'</span>,<span class="number">74</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">18</span>,<span class="number">108</span>,<span class="string">'语文'</span>,<span class="number">19</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">19</span>,<span class="number">109</span>,<span class="string">'语文'</span>,<span class="number">29</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">20</span>,<span class="number">110</span>,<span class="string">'语文'</span>,<span class="number">26</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">21</span>,<span class="number">101</span>,<span class="string">'英语'</span>,<span class="number">55</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">22</span>,<span class="number">102</span>,<span class="string">'英语'</span>,<span class="number">24</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">23</span>,<span class="number">103</span>,<span class="string">'英语'</span>,<span class="number">38</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">24</span>,<span class="number">104</span>,<span class="string">'英语'</span>,<span class="number">82</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">25</span>,<span class="number">105</span>,<span class="string">'英语'</span>,<span class="number">12</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">26</span>,<span class="number">106</span>,<span class="string">'英语'</span>,<span class="number">15</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">27</span>,<span class="number">107</span>,<span class="string">'英语'</span>,<span class="number">50</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">28</span>,<span class="number">108</span>,<span class="string">'英语'</span>,<span class="number">68</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">29</span>,<span class="number">109</span>,<span class="string">'英语'</span>,<span class="number">77</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">30</span>,<span class="number">110</span>,<span class="string">'英语'</span>,<span class="number">19</span>);</div></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="查询所有课程分数都大于50分的学生信息"><a href="#查询所有课程分数都大于50分的学生信息" class="headerlink" title="查询所有课程分数都大于50分的学生信息"></a>查询所有课程分数都大于50分的学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	*</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_student </div><div class="line"><span class="keyword">where</span> </div><div class="line">	s_id <span class="keyword">in</span> (</div><div class="line">		<span class="comment">-- 按学生ID分组，看每个学生的最低分数是否大于50分</span></div><div class="line">		<span class="keyword">select</span> </div><div class="line">			s_id</div><div class="line">		<span class="keyword">from</span> </div><div class="line">			t_score </div><div class="line">		<span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">			s_id </div><div class="line">		<span class="keyword">having</span> </div><div class="line">			<span class="keyword">min</span>(score)&gt;=<span class="number">50</span></div><div class="line">);</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-03.png-blog.photo" alt="data-analyst-interview-sql-04-03"></p>
<h2 id="换另一种方式，实现上一题"><a href="#换另一种方式，实现上一题" class="headerlink" title="换另一种方式，实现上一题"></a>换另一种方式，实现上一题</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	*</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_student </div><div class="line"><span class="keyword">where</span> </div><div class="line">	s_id <span class="keyword">not</span> <span class="keyword">in</span> (</div><div class="line">		<span class="comment">-- 查询分数小于50分的学生ID</span></div><div class="line">		<span class="keyword">select</span> s_id <span class="keyword">from</span> t_score <span class="keyword">where</span> score &lt; <span class="number">50</span></div><div class="line">) <span class="keyword">and</span> s_id <span class="keyword">in</span> (</div><div class="line">		<span class="comment">-- 加上这个判断，是因为有的学生没有考试成绩</span></div><div class="line">		<span class="keyword">select</span> s_id <span class="keyword">from</span> t_score</div><div class="line">);</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-03.png-blog.photo" alt="data-analyst-interview-sql-04-03"></p>
<h2 id="查询最少有2门课程都-gt-60分的学生信息"><a href="#查询最少有2门课程都-gt-60分的学生信息" class="headerlink" title="查询最少有2门课程都&gt;=60分的学生信息"></a>查询最少有2门课程都&gt;=60分的学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	*</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_student </div><div class="line"><span class="keyword">where</span> </div><div class="line">	s_id <span class="keyword">in</span> </div><div class="line">(</div><div class="line">	<span class="keyword">select</span> </div><div class="line">		s_id</div><div class="line">	<span class="keyword">from</span> </div><div class="line">		t_score </div><div class="line">	<span class="keyword">where</span> </div><div class="line">		score&gt;=<span class="number">60</span> </div><div class="line">	<span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">		s_id </div><div class="line">	<span class="keyword">having</span> </div><div class="line">		<span class="keyword">count</span>(<span class="number">1</span>)&gt;=<span class="number">2</span></div><div class="line">);</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-04.png-blog.photo" alt="data-analyst-interview-sql-04-04"></p>
<h2 id="查询每个学生的个人信息及班级信息及所有科目分数，按照班级ID升序排列，课程分数降序排列"><a href="#查询每个学生的个人信息及班级信息及所有科目分数，按照班级ID升序排列，课程分数降序排列" class="headerlink" title="查询每个学生的个人信息及班级信息及所有科目分数，按照班级ID升序排列，课程分数降序排列"></a>查询每个学生的个人信息及班级信息及所有科目分数，按照班级ID升序排列，课程分数降序排列</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	a.*,b.c_name,c.course_name,c.score</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_student a</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_class b </div><div class="line"><span class="keyword">on</span> </div><div class="line">	b.c_id = a.c_id</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_score c </div><div class="line"><span class="keyword">on</span> </div><div class="line">	c.s_id = a.s_id</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span></div><div class="line">	a.c_id <span class="keyword">asc</span>,</div><div class="line">	c.score <span class="keyword">desc</span> </div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-01.png-blog.photo" alt="data-analyst-interview-sql-04-01"></p>
<h2 id="查询每个学生的学生ID、学生姓名、班级名称、总分、平均分，按照班级名称升序、总分降序排列"><a href="#查询每个学生的学生ID、学生姓名、班级名称、总分、平均分，按照班级名称升序、总分降序排列" class="headerlink" title="查询每个学生的学生ID、学生姓名、班级名称、总分、平均分，按照班级名称升序、总分降序排列"></a>查询每个学生的学生ID、学生姓名、班级名称、总分、平均分，按照班级名称升序、总分降序排列</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	a.s_id,</div><div class="line">	a.s_name,</div><div class="line">	b.c_name,</div><div class="line">	<span class="keyword">sum</span>(c.score) total_score,</div><div class="line">	<span class="keyword">avg</span>(c.score) avg_score</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_student a</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_class b </div><div class="line"><span class="keyword">on</span> </div><div class="line">	b.c_id = a.c_id</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_score c </div><div class="line"><span class="keyword">on</span> </div><div class="line">	c.s_id = a.s_id</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">	a.s_id,</div><div class="line">	a.s_name,</div><div class="line">	b.c_name</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	b.c_name,</div><div class="line">	total_score <span class="keyword">desc</span></div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-02.png-blog.photo" alt="data-analyst-interview-sql-04-02"></p>
<h2 id="上一题，加上平均分大于60分"><a href="#上一题，加上平均分大于60分" class="headerlink" title="上一题，加上平均分大于60分"></a>上一题，加上平均分大于60分</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	a.s_id,</div><div class="line">	a.s_name,</div><div class="line">	b.c_name,</div><div class="line">	<span class="keyword">sum</span>(c.score) total_score,</div><div class="line">	<span class="keyword">avg</span>(c.score) avg_score</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_student a</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_class b </div><div class="line"><span class="keyword">on</span> </div><div class="line">	b.c_id = a.c_id</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_score c </div><div class="line"><span class="keyword">on</span> </div><div class="line">	c.s_id = a.s_id</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">	a.s_id,</div><div class="line">	a.s_name,</div><div class="line">	b.c_name</div><div class="line"><span class="keyword">having</span> </div><div class="line">	avg_score &gt;= <span class="number">60</span></div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	b.c_name,</div><div class="line">	total_score <span class="keyword">desc</span></div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-05.png-blog.photo" alt="data-analyst-interview-sql-04-05"></p>
<h2 id="查询数学成绩比语文成绩高的所有学生信息及数学、语文的成绩"><a href="#查询数学成绩比语文成绩高的所有学生信息及数学、语文的成绩" class="headerlink" title="查询数学成绩比语文成绩高的所有学生信息及数学、语文的成绩"></a>查询数学成绩比语文成绩高的所有学生信息及数学、语文的成绩</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 使用子查询</span></div><div class="line"><span class="keyword">select</span></div><div class="line">	x.*,</div><div class="line">	a.course_name course_math,</div><div class="line">	a.score math_score,</div><div class="line">	b.course_name course_language ,</div><div class="line">	b.score language_score</div><div class="line"><span class="keyword">from</span></div><div class="line">	t_student x</div><div class="line"><span class="keyword">join</span> </div><div class="line">(</div><div class="line">	<span class="comment">-- 所有学生的数学成绩</span></div><div class="line">	<span class="keyword">select</span></div><div class="line">		*</div><div class="line">	<span class="keyword">from</span> </div><div class="line">		t_score</div><div class="line">	<span class="keyword">WHERE</span></div><div class="line">		course_name = <span class="string">'数学'</span></div><div class="line">) a</div><div class="line"><span class="keyword">on</span> </div><div class="line">	x.s_id = a.s_id</div><div class="line"><span class="keyword">join</span> (</div><div class="line">	<span class="comment">-- 所有学生的语文成绩</span></div><div class="line">	<span class="keyword">select</span></div><div class="line">		*</div><div class="line">	<span class="keyword">from</span> </div><div class="line">		t_score</div><div class="line">	<span class="keyword">WHERE</span></div><div class="line">		course_name = <span class="string">'语文'</span></div><div class="line">) b </div><div class="line"><span class="keyword">on</span> </div><div class="line">	a.s_id = b.s_id</div><div class="line"><span class="keyword">and</span> </div><div class="line">	b.score &lt;= a.score</div><div class="line">;</div><div class="line"></div><div class="line"><span class="comment">-- 2. 使用join</span></div><div class="line"><span class="keyword">select</span></div><div class="line">	x.*,</div><div class="line">	y.course_name course_math,</div><div class="line">	y.score math_score,</div><div class="line">	z.course_name course_language ,</div><div class="line">	z.score language_score</div><div class="line"><span class="keyword">from</span></div><div class="line">	t_student x</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_score y</div><div class="line"><span class="keyword">ON</span></div><div class="line">	x.s_id = y.s_id</div><div class="line"><span class="keyword">and</span> </div><div class="line">	course_name = <span class="string">'数学'</span></div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_score z</div><div class="line"><span class="keyword">on</span> </div><div class="line">	z.course_name = <span class="string">'语文'</span></div><div class="line"><span class="keyword">and</span> </div><div class="line">	z.s_id = y.s_id </div><div class="line"><span class="keyword">and</span> </div><div class="line">	z.score &lt;= y.score</div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-90576d5281d0c7eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="语文成绩比数学成绩好的"></p>
<h2 id="查询英语和语文成绩都大于60的学生信息"><a href="#查询英语和语文成绩都大于60的学生信息" class="headerlink" title="查询英语和语文成绩都大于60的学生信息"></a>查询英语和语文成绩都大于60的学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> x.* <span class="keyword">from</span> t_student x</div><div class="line"><span class="keyword">join</span> (</div><div class="line">	<span class="keyword">select</span> </div><div class="line">		a.s_id</div><div class="line">	<span class="keyword">from</span> </div><div class="line">		t_score a</div><div class="line">	<span class="keyword">where</span> </div><div class="line">		a.score &gt; <span class="number">60</span></div><div class="line">	<span class="keyword">and</span> </div><div class="line">		a.course_name <span class="keyword">in</span> (<span class="string">'英语'</span>,<span class="string">'语文'</span>)</div><div class="line">	<span class="keyword">group</span> <span class="keyword">by</span></div><div class="line">		a.s_id </div><div class="line">	<span class="keyword">having</span></div><div class="line">		<span class="keyword">count</span>(<span class="number">1</span>) = <span class="number">2</span></div><div class="line">) y </div><div class="line"><span class="keyword">on</span> y.s_id=x.s_id</div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-06.png-blog.photo" alt="data-analyst-interview-sql-04-06"></p>
<h2 id="查询每个学生的学生ID、学生姓名及平均分-按照平局分降序排列"><a href="#查询每个学生的学生ID、学生姓名及平均分-按照平局分降序排列" class="headerlink" title="查询每个学生的学生ID、学生姓名及平均分,按照平局分降序排列"></a>查询每个学生的学生ID、学生姓名及平均分,按照平局分降序排列</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	b.s_id,</div><div class="line">	b.s_name,</div><div class="line">	<span class="keyword">avg</span>(a.score) avg_score</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_score a</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_student b </div><div class="line"><span class="keyword">on</span> </div><div class="line">	b.s_id = a.s_id</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">	b.s_id,</div><div class="line">	b.s_name</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	avg_score <span class="keyword">desc</span></div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-07.png-blog.photo" alt="data-analyst-interview-sql-04-07"></p>
<h2 id="上一题，加上，平局分大于60分"><a href="#上一题，加上，平局分大于60分" class="headerlink" title="上一题，加上，平局分大于60分"></a>上一题，加上，平局分大于60分</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	b.s_id,</div><div class="line">	b.s_name,</div><div class="line">	<span class="keyword">avg</span>(a.score) avg_score</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_score a</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_student b </div><div class="line"><span class="keyword">on</span> </div><div class="line">	b.s_id = a.s_id</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">	b.s_id,</div><div class="line">	b.s_name</div><div class="line"><span class="keyword">having</span> </div><div class="line">	avg_score &gt; <span class="number">60</span></div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	avg_score <span class="keyword">desc</span></div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-08.png-blog.photo" alt="data-analyst-interview-sql-04-08"></p>
<h2 id="上上一题，加上只查看平均分最高的学生信息"><a href="#上上一题，加上只查看平均分最高的学生信息" class="headerlink" title="上上一题，加上只查看平均分最高的学生信息"></a>上上一题，加上只查看平均分最高的学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	b.s_id,</div><div class="line">	b.s_name,</div><div class="line">	<span class="keyword">avg</span>(a.score) avg_score</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_score a</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_student b </div><div class="line"><span class="keyword">on</span> </div><div class="line">	b.s_id = a.s_id</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">	b.s_id,</div><div class="line">	b.s_name</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	avg_score <span class="keyword">desc</span></div><div class="line"><span class="keyword">limit</span> <span class="number">1</span></div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-09.png-blog.photo" alt="data-analyst-interview-sql-04-09"></p>
<h2 id="上上上一题，加上平局分第3高的学生信息"><a href="#上上上一题，加上平局分第3高的学生信息" class="headerlink" title="上上上一题，加上平局分第3高的学生信息"></a>上上上一题，加上平局分第3高的学生信息</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	b.s_id,</div><div class="line">	b.s_name,</div><div class="line">	<span class="keyword">avg</span>(a.score) avg_score</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_score a</div><div class="line"><span class="keyword">join</span> </div><div class="line">	t_student b </div><div class="line"><span class="keyword">on</span> </div><div class="line">	b.s_id = a.s_id</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">	b.s_id,</div><div class="line">	b.s_name</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	avg_score <span class="keyword">desc</span></div><div class="line"><span class="keyword">limit</span> <span class="number">1</span> <span class="keyword">offset</span> <span class="number">2</span></div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-10.png-blog.photo" alt="data-analyst-interview-sql-04-10"></p>
<h2 id="换一种方式实现上一题"><a href="#换一种方式实现上一题" class="headerlink" title="换一种方式实现上一题"></a>换一种方式实现上一题</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	x.s_id,</div><div class="line">	x.s_name,</div><div class="line">	x.avg_score,</div><div class="line">	@cur_rank := @cur_rank+<span class="number">1</span> <span class="keyword">as</span> score_rank</div><div class="line"><span class="keyword">from</span> (</div><div class="line">	<span class="keyword">select</span> </div><div class="line">		b.s_id,</div><div class="line">		b.s_name,</div><div class="line">		<span class="keyword">avg</span>(a.score) avg_score</div><div class="line">	<span class="keyword">from</span> </div><div class="line">		t_score a</div><div class="line">	<span class="keyword">join</span> </div><div class="line">		t_student b </div><div class="line">	<span class="keyword">on</span> </div><div class="line">		b.s_id = a.s_id</div><div class="line">	<span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">		b.s_id,</div><div class="line">		b.s_name</div><div class="line">) x</div><div class="line"><span class="keyword">cross</span> <span class="keyword">join</span> (</div><div class="line">	<span class="keyword">select</span> @cur_rank:=<span class="number">0</span></div><div class="line">)y</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	x.avg_score <span class="keyword">desc</span>;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-12.png-blog.photo" alt="data-analyst-interview-sql-04-12"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;SQL笔试题&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;下面的SQL基于MySQL&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;下面整理些MySQL学习过程中，基本的练习题，题目来源于网上及个人总结。&lt;/p&gt;
&lt;h2 id=&quot;测试数据&quot;&gt;&lt;a href=&quot;#测试数据&quot; class=&quot;headerlink&quot; title=&quot;测试数据&quot;&gt;&lt;/a&gt;测试数据&lt;/h2&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;40&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;41&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;42&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;43&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;44&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;45&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;46&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;47&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;48&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;49&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;50&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;51&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;52&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;53&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;54&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;55&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;56&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;57&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;58&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;59&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;60&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;61&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;62&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;63&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;64&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;65&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;66&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;67&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;68&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;69&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;70&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; t_student(&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	s_id &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;学生ID&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	s_name &lt;span class=&quot;built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;学生姓名&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	s_gender &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;学生性别 0-男,1-女&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	s_birthday &lt;span class=&quot;built_in&quot;&gt;date&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;出生日期&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	s_hobby &lt;span class=&quot;built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;爱好&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	c_id &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;班级ID&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;) &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;学生表&#39;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; t_class(&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	c_id &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;班级ID&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	c_name &lt;span class=&quot;built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;班级名称&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;) &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;班级表&#39;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;table&lt;/span&gt; t_score(&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	sc_id &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;成绩ID&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	s_id &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;学生ID&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	course_name &lt;span class=&quot;built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;课程名称&#39;&lt;/span&gt;,&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	score &lt;span class=&quot;built_in&quot;&gt;numeric&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;成绩&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;	&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;) &lt;span class=&quot;keyword&quot;&gt;comment&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&#39;成绩表&#39;&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_class &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;901&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;一班&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_class &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;902&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;二班&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_class &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;903&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;三班&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_class &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;905&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;五班&#39;&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;路飞&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1990-01-26&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;吃肉,睡觉&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;901&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;娜美&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1995-10-05&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;足球,篮球&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;901&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;103&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;乔巴&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1992-08-11&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;唱歌,吃肉&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;901&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;104&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;鸣人&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1991-03-29&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;拉面,忍术&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;901&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;卡卡西&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1989-05-10&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;看书,吃肉&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;902&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;乌索普&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1988-02-02&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;跳舞,篮球&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;902&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;乔峰&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1990-12-12&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;跑步,羽毛球&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;902&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;段誉&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1990-12-13&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;吃肉,加班&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;903&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;虚竹&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1991-01-22&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;看电影,旅行&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;903&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;110&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;杨过&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;2000-03-04&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;旅行&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;903&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;令狐冲&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;1997-03-04&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;喝酒&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;904&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;103&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;104&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;84&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;110&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;67&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;71&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;103&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;104&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;16&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;110&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;23&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;103&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;104&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;29&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;77&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; t_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;110&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="笔试题" scheme="https://yuguiyang.github.io/categories/%E7%AC%94%E8%AF%95%E9%A2%98/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="笔试题" scheme="https://yuguiyang.github.io/tags/%E7%AC%94%E8%AF%95%E9%A2%98/"/>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-关联查询</title>
    <link href="https://yuguiyang.github.io/2017/09/09/mysql-handbook-03/"/>
    <id>https://yuguiyang.github.io/2017/09/09/mysql-handbook-03/</id>
    <published>2017-09-09T02:00:00.000Z</published>
    <updated>2017-09-09T14:47:09.459Z</updated>
    
    <content type="html"><![CDATA[<p>MySQL<br>关联查询</p>
<p>前面，我们介绍的都是单表查询（就是只从一张表中获取数据），而实际应用的时候，我们都会同时查询多张表，这里，我们就介绍下，多表关联查询的使用。</p>
<blockquote>
<p>SQL join 用于根据两个或多个表中的列之间的关系，从这些表中查询数据</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-d28b309853b85c19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="关联查询.png"></p>
<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><blockquote>
<p>主键（Primary Key）：可以唯一确定一条记录的字段，比如学生表中的学生ID，生活中我们的身份证号<br>外键（Foreign Key）：指向另一张表的主键，比如学生表中的班级ID，班级ID是班级表中的主键，但在学生表中是外键</p>
</blockquote>
<p>主键和外键可以在建表的时候指定，他可以在数据库层面，控制你的数据的完整性、一致性。</p>
<a id="more"></a>
<p>测试数据参考：<a href="http://yuguiyang.github.io/2017/09/09/mysql-handbook-01/">http://yuguiyang.github.io/2017/09/09/mysql-handbook-01/</a></p>
<h2 id="inner-join"><a href="#inner-join" class="headerlink" title="inner join"></a>inner join</h2><p>inner join 可以简写为 join，结果集是两张表中 <strong>都存在的记录</strong>，是一个交集，详情参考上面的图片。<br>比如：在学生表中，有一个班级ID，我们想根据班级ID，在班级表中找到班级信息<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">    *</div><div class="line"><span class="keyword">from</span> </div><div class="line">    t_student a </div><div class="line"><span class="comment">-- 要关联查询的表</span></div><div class="line"><span class="keyword">join</span> </div><div class="line">    t_class b </div><div class="line"><span class="comment">-- 使用什么字段去关联这两张表</span></div><div class="line"><span class="keyword">on</span> </div><div class="line">    a.c_id = b.c_id</div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-a5ae853962b43597.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="join"></p>
<h2 id="left-join"><a href="#left-join" class="headerlink" title="left join"></a>left join</h2><p>左关联，以左边的表为主表，不管外键在右表中是否存在，左表的数据都会存在。<br>比如学生表中，有这样一条记录，他的班级ID是904，但是班级表中并没有904的班级信息，<br>所以，使用join的话是查不到这条记录的<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 2. left join </span></div><div class="line"><span class="comment">-- 学生表为主表，包含所有学生信息</span></div><div class="line"><span class="keyword">select</span> </div><div class="line">    *</div><div class="line"><span class="keyword">from</span> </div><div class="line">    t_student a </div><div class="line"><span class="keyword">left</span> <span class="keyword">join</span> </div><div class="line">    t_class b </div><div class="line"><span class="keyword">on</span> </div><div class="line">    a.c_id = b.c_id</div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-fc4ed0f6e9def043.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="left join"></p>
<h2 id="right-join"><a href="#right-join" class="headerlink" title="right join"></a>right join</h2><p>右关联，和做关联类似，但已右表为主表<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">-- 3. right join </span></div><div class="line"><span class="comment">-- 班级表为主表，不管改班级是否有学生信息</span></div><div class="line"><span class="keyword">select</span> </div><div class="line">    *</div><div class="line"><span class="keyword">from</span> </div><div class="line">    t_student a </div><div class="line"><span class="keyword">right</span> <span class="keyword">join</span> </div><div class="line">    t_class b </div><div class="line"><span class="keyword">on</span> </div><div class="line">    a.c_id = b.c_id</div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-f5a4a9876a971a43.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="right join"></p>
<h2 id="full-outer-join"><a href="#full-outer-join" class="headerlink" title="full outer join"></a>full outer join</h2><p>全关联，mysql没有full join 语法，我们可以通过使用union来实现<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">    *</div><div class="line"><span class="keyword">from</span> </div><div class="line">    t_student a </div><div class="line"><span class="keyword">left</span> <span class="keyword">join</span> </div><div class="line">    t_class b </div><div class="line"><span class="keyword">on</span> </div><div class="line">    a.c_id = b.c_id</div><div class="line"><span class="keyword">UNION</span></div><div class="line"><span class="keyword">select</span> </div><div class="line">    *</div><div class="line"><span class="keyword">from</span> </div><div class="line">    t_student a </div><div class="line"><span class="keyword">right</span> <span class="keyword">join</span> </div><div class="line">    t_class b </div><div class="line"><span class="keyword">on</span> </div><div class="line">    a.c_id = b.c_id</div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-f5d58640d50dbd22.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="full join"></p>
<h2 id="cross-join"><a href="#cross-join" class="headerlink" title="cross join"></a>cross join</h2><p>cross join 是对2个表做笛卡尔积<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_class a </div><div class="line"><span class="keyword">cross</span> <span class="keyword">join</span> t_class b </div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> a.c_id,b.c_id</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-04-11.png-blog.photo" alt="data-analyst-interview-sql-04-11"></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>关联查询的话，我们主要是选择好主表，然后找好表与表之间的关联关系，注意多对多、一对多的这种关系，验证号结果数据就行了。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MySQL&lt;br&gt;关联查询&lt;/p&gt;
&lt;p&gt;前面，我们介绍的都是单表查询（就是只从一张表中获取数据），而实际应用的时候，我们都会同时查询多张表，这里，我们就介绍下，多表关联查询的使用。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;SQL join 用于根据两个或多个表中的列之间的关系，从这些表中查询数据&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/76024-d28b309853b85c19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;关联查询.png&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;前置知识&quot;&gt;&lt;a href=&quot;#前置知识&quot; class=&quot;headerlink&quot; title=&quot;前置知识&quot;&gt;&lt;/a&gt;前置知识&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;主键（Primary Key）：可以唯一确定一条记录的字段，比如学生表中的学生ID，生活中我们的身份证号&lt;br&gt;外键（Foreign Key）：指向另一张表的主键，比如学生表中的班级ID，班级ID是班级表中的主键，但在学生表中是外键&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;主键和外键可以在建表的时候指定，他可以在数据库层面，控制你的数据的完整性、一致性。&lt;/p&gt;
    
    </summary>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/categories/MySQL/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-中文排序</title>
    <link href="https://yuguiyang.github.io/2017/09/09/mysql-handbook-02/"/>
    <id>https://yuguiyang.github.io/2017/09/09/mysql-handbook-02/</id>
    <published>2017-09-09T01:00:00.000Z</published>
    <updated>2017-09-09T10:50:41.221Z</updated>
    
    <content type="html"><![CDATA[<p>MySQL<br>中文排序</p>
<p>测试数据参考：<a href="http://yuguiyang.github.io/2017/09/09/mysql-handbook-01/">http://yuguiyang.github.io/2017/09/09/mysql-handbook-01/</a></p>
<p>以前还真没有关注这个中文排序的问题，这里记录下。</p>
<p>一张学生表<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-26480895de68e815.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="学生表"></p>
<p>我们根据s_name来排序<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">order</span> <span class="keyword">by</span> s_name;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-0f5ecf1f3512536d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="根据s_name排序"></p>
<p>这里的中文排序，是不对的，应该是由于字符集的问题，一般情况下，数据库中的编码都是使用UTF-8的，所以，对于中文会有问题。</p>
<p>从网上找到2中解决办法</p>
<a id="more"></a>
<h2 id="create-table的时候加上binary属性（经测试，不好用）"><a href="#create-table的时候加上binary属性（经测试，不好用）" class="headerlink" title="create table的时候加上binary属性（经测试，不好用）"></a>create table的时候加上binary属性（经测试，不好用）</h2><p>注意下s_name字段，我们添加了binary属性<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`t_student_test`</span> (</div><div class="line">  <span class="string">`s_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'学生ID'</span>,</div><div class="line">  <span class="string">`s_name`</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="built_in">binary</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'学生姓名'</span>,</div><div class="line">  <span class="string">`s_gender`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'学生性别 0-男,1-女'</span>,</div><div class="line">  <span class="string">`s_birthday`</span> <span class="built_in">date</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'出生日期'</span>,</div><div class="line">  <span class="string">`s_hobby`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'爱好'</span>,</div><div class="line">  <span class="string">`c_id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'班级ID'</span></div><div class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'学生表'</span>;</div></pre></td></tr></table></figure></p>
<p>这里，我试验是失败的，中文排序依然不对</p>
<h2 id="在order-by-后面，使用-convert函数"><a href="#在order-by-后面，使用-convert函数" class="headerlink" title="在order by 后面，使用 convert函数"></a>在order by 后面，使用 convert函数</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">convert</span>(s_name <span class="keyword">using</span> gbk);</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-27d3391d7061ae9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="中文排序"></p>
<p>使用convert函数是可以的，没有问题</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MySQL&lt;br&gt;中文排序&lt;/p&gt;
&lt;p&gt;测试数据参考：&lt;a href=&quot;http://yuguiyang.github.io/2017/09/09/mysql-handbook-01/&quot;&gt;http://yuguiyang.github.io/2017/09/09/mysql-handbook-01/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;以前还真没有关注这个中文排序的问题，这里记录下。&lt;/p&gt;
&lt;p&gt;一张学生表&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; *&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; t_student;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/76024-26480895de68e815.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;学生表&quot;&gt;&lt;/p&gt;
&lt;p&gt;我们根据s_name来排序&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;select&lt;/span&gt; *&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; t_student &lt;span class=&quot;keyword&quot;&gt;order&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;by&lt;/span&gt; s_name;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/76024-0f5ecf1f3512536d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;根据s_name排序&quot;&gt;&lt;/p&gt;
&lt;p&gt;这里的中文排序，是不对的，应该是由于字符集的问题，一般情况下，数据库中的编码都是使用UTF-8的，所以，对于中文会有问题。&lt;/p&gt;
&lt;p&gt;从网上找到2中解决办法&lt;/p&gt;
    
    </summary>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/categories/MySQL/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL-基本语法介绍</title>
    <link href="https://yuguiyang.github.io/2017/09/09/mysql-handbook-01/"/>
    <id>https://yuguiyang.github.io/2017/09/09/mysql-handbook-01/</id>
    <published>2017-09-09T00:00:00.000Z</published>
    <updated>2017-09-09T10:25:04.832Z</updated>
    
    <content type="html"><![CDATA[<p>MySQL<br>基本语法介绍</p>
<h2 id="1-什么是SQL"><a href="#1-什么是SQL" class="headerlink" title="1. 什么是SQL"></a>1. 什么是SQL</h2><p>SQL（Structured Query Language）结构化查询语言，通过SQL，我们就可以查询数据库中的数据，而数据再数据库中又是以表的形式保存的，所以SQL查询，主要就是对表进行查询。</p>
<p>SQL的语法就和学习英语的语法、汉语拼音一样，满足给定的套路，去使用就可以了。</p>
<p>当我们拿到了数据库的连接信息，连接到一个数据库上，我们就可以开始写SQL了。</p>
<h2 id="2-Navicat的使用"><a href="#2-Navicat的使用" class="headerlink" title="2. Navicat的使用"></a>2. Navicat的使用</h2><p>MySQL的客户端有很多，通常使用的，可能有Navicat，还有MySQL自带的workbench。<br>Navicat是收费产品，但在网上可以找到XX版，workbench是免费的。</p>
<p>这里以Navicat为例，简单介绍下。<br><img src="http://upload-images.jianshu.io/upload_images/76024-c7a0409bf6b9a087.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="菜单-新建连接"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-4e9a9e1bce14c574.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="新建连接"><br>在这里，输入数据库地址、用户名、密码等等就行了。</p>
<p>这一个一个圆柱形的，就是一个数据库实例，下面那些电子表格图标的就是表，数据就存储在表中。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-cfabf6503b213d37.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="数据库及表"></p>
<a id="more"></a>
<p>默认是不会看到表结构信息的，我们勾选下面的配置之后，就可以看到了<br><img src="http://upload-images.jianshu.io/upload_images/76024-14e110741cf8f15d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="对象信息"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-49271a0110fe3798.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="表结构信息"></p>
<h2 id="3-基本语法"><a href="#3-基本语法" class="headerlink" title="3. 基本语法"></a>3. 基本语法</h2><h3 id="数据准备"><a href="#数据准备" class="headerlink" title="数据准备"></a>数据准备</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_student(</div><div class="line">    s_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'学生ID'</span>,</div><div class="line">    s_name <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">comment</span> <span class="string">'学生姓名'</span>,</div><div class="line">    s_gender <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'学生性别 0-男,1-女'</span>,</div><div class="line">    s_birthday <span class="built_in">date</span> <span class="keyword">comment</span> <span class="string">'出生日期'</span>,</div><div class="line">    s_hobby <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">comment</span> <span class="string">'爱好'</span>,</div><div class="line">    c_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'班级ID'</span></div><div class="line">) <span class="keyword">comment</span> <span class="string">'学生表'</span>;</div><div class="line"></div><div class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_class(</div><div class="line">    c_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'班级ID'</span>,</div><div class="line">    c_name <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">comment</span> <span class="string">'班级名称'</span></div><div class="line">) <span class="keyword">comment</span> <span class="string">'班级表'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_score(</div><div class="line">    sc_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'成绩ID'</span>,</div><div class="line">    s_id <span class="built_in">int</span> <span class="keyword">comment</span> <span class="string">'学生ID'</span>,</div><div class="line">    course_name <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">comment</span> <span class="string">'课程名称'</span>,</div><div class="line">    score <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">comment</span> <span class="string">'成绩'</span></div><div class="line">    </div><div class="line">) <span class="keyword">comment</span> <span class="string">'成绩表'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">901</span>,<span class="string">'一班'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">902</span>,<span class="string">'二班'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_class <span class="keyword">values</span>(<span class="number">903</span>,<span class="string">'三班'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">101</span>,<span class="string">'路飞'</span>,<span class="number">0</span>,<span class="string">'1990-01-26'</span>,<span class="string">'吃肉,睡觉'</span>,<span class="number">901</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">102</span>,<span class="string">'娜美'</span>,<span class="number">1</span>,<span class="string">'1995-10-05'</span>,<span class="string">'足球,篮球'</span>,<span class="number">901</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">103</span>,<span class="string">'乔巴'</span>,<span class="number">0</span>,<span class="string">'1992-08-11'</span>,<span class="string">'唱歌,吃肉'</span>,<span class="number">901</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">104</span>,<span class="string">'鸣人'</span>,<span class="number">0</span>,<span class="string">'1991-03-29'</span>,<span class="string">'拉面,忍术'</span>,<span class="number">901</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">105</span>,<span class="string">'卡卡西'</span>,<span class="number">1</span>,<span class="string">'1989-05-10'</span>,<span class="string">'看书,吃肉'</span>,<span class="number">902</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">106</span>,<span class="string">'乌索普'</span>,<span class="number">1</span>,<span class="string">'1988-02-02'</span>,<span class="string">'跳舞,篮球'</span>,<span class="number">902</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">107</span>,<span class="string">'乔峰'</span>,<span class="number">0</span>,<span class="string">'1990-12-12'</span>,<span class="string">'跑步,羽毛球'</span>,<span class="number">902</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">108</span>,<span class="string">'段誉'</span>,<span class="number">0</span>,<span class="string">'1990-12-13'</span>,<span class="string">'吃肉,加班'</span>,<span class="number">903</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">109</span>,<span class="string">'虚竹'</span>,<span class="number">1</span>,<span class="string">'1991-01-22'</span>,<span class="string">'看电影,旅行'</span>,<span class="number">903</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_student <span class="keyword">values</span>(<span class="number">110</span>,<span class="string">'杨过'</span>,<span class="number">0</span>,<span class="string">'2000-03-04'</span>,<span class="string">'旅行'</span>,<span class="number">903</span>);</div><div class="line"></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">1</span>,<span class="number">101</span>,<span class="string">'数学'</span>,<span class="number">39</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">2</span>,<span class="number">102</span>,<span class="string">'数学'</span>,<span class="number">20</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">3</span>,<span class="number">103</span>,<span class="string">'数学'</span>,<span class="number">54</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">4</span>,<span class="number">104</span>,<span class="string">'数学'</span>,<span class="number">38</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">5</span>,<span class="number">105</span>,<span class="string">'数学'</span>,<span class="number">70</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">6</span>,<span class="number">106</span>,<span class="string">'数学'</span>,<span class="number">15</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">7</span>,<span class="number">107</span>,<span class="string">'数学'</span>,<span class="number">75</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">8</span>,<span class="number">108</span>,<span class="string">'数学'</span>,<span class="number">84</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">9</span>,<span class="number">109</span>,<span class="string">'数学'</span>,<span class="number">87</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">10</span>,<span class="number">110</span>,<span class="string">'数学'</span>,<span class="number">67</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">11</span>,<span class="number">101</span>,<span class="string">'语文'</span>,<span class="number">73</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">12</span>,<span class="number">102</span>,<span class="string">'语文'</span>,<span class="number">71</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">13</span>,<span class="number">103</span>,<span class="string">'语文'</span>,<span class="number">82</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">14</span>,<span class="number">104</span>,<span class="string">'语文'</span>,<span class="number">83</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">15</span>,<span class="number">105</span>,<span class="string">'语文'</span>,<span class="number">36</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">16</span>,<span class="number">106</span>,<span class="string">'语文'</span>,<span class="number">87</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">17</span>,<span class="number">107</span>,<span class="string">'语文'</span>,<span class="number">74</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">18</span>,<span class="number">108</span>,<span class="string">'语文'</span>,<span class="number">19</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">19</span>,<span class="number">109</span>,<span class="string">'语文'</span>,<span class="number">29</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">20</span>,<span class="number">110</span>,<span class="string">'语文'</span>,<span class="number">26</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">21</span>,<span class="number">101</span>,<span class="string">'英语'</span>,<span class="number">55</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">22</span>,<span class="number">102</span>,<span class="string">'英语'</span>,<span class="number">24</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">23</span>,<span class="number">103</span>,<span class="string">'英语'</span>,<span class="number">38</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">24</span>,<span class="number">104</span>,<span class="string">'英语'</span>,<span class="number">82</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">25</span>,<span class="number">105</span>,<span class="string">'英语'</span>,<span class="number">12</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">26</span>,<span class="number">106</span>,<span class="string">'英语'</span>,<span class="number">15</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">27</span>,<span class="number">107</span>,<span class="string">'英语'</span>,<span class="number">50</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">28</span>,<span class="number">108</span>,<span class="string">'英语'</span>,<span class="number">68</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">29</span>,<span class="number">109</span>,<span class="string">'英语'</span>,<span class="number">77</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_score <span class="keyword">values</span>(<span class="number">30</span>,<span class="number">110</span>,<span class="string">'英语'</span>,<span class="number">19</span>);</div></pre></td></tr></table></figure>
<h3 id="select"><a href="#select" class="headerlink" title="select"></a>select</h3><p>下面，我们来看看，怎样查看一张表的数据；SQL的语法呢，就好比是一个公式，初学的话我们去套用就可以了。</p>
<blockquote>
<p>SELECT 列名称 FROM 表名称<br>或者<br>SELECT * FROM 表名称</p>
</blockquote>
<p>使用Navicat执行查询<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 查看学生表数据，指定字段</span></div><div class="line"><span class="keyword">select</span> s_id,s_name <span class="keyword">from</span> t_student;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-9d37e4bef2b2880e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="学生表数据"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 查看所有字段</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student;</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-eae6d5cb5d674dc1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="学生表数据"></p>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><p>排序是很常用的功能，我们想要对结果集进行指定的排序，就要使用order by</p>
<blockquote>
<p>order by 字段名<br>默认升序，可以使用desc降序排列</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 学生ID降序排列</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">order</span> <span class="keyword">by</span> s_id <span class="keyword">desc</span>;</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-d84dba85f11f7c15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="降序排列"></p>
<p>多字段排序<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 班级ID升序排列，班级ID一样的按学生ID降序排列</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">order</span> <span class="keyword">by</span> c_id,s_id <span class="keyword">desc</span>;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-367ec9920a3fa2fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="多字段排序"></p>
<h3 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h3><blockquote>
<p>指定返回记录的数目</p>
</blockquote>
<p>我们上面，都是查询一张表所有的数据，有的时候表的数据量很大，或者我们只想看看排名前3的数据，我们就可以使用limit<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 学生ID降序排列,取前3条记录</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">order</span> <span class="keyword">by</span> s_id <span class="keyword">desc</span> <span class="keyword">limit</span> <span class="number">3</span>;</div></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-2e411a4cfdc54cdd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="limit"></p>
<h3 id="where"><a href="#where" class="headerlink" title="where"></a>where</h3><p>前面，我们可以查看一张表的所有数据、做排序、然后只取前几行，实际使用时，一定会有这样的需求，比如我们只想看学生ID是105的记录，就需要使用where了，它可以对数据进行过滤。</p>
<blockquote>
<p>SELECT 列名称 FROM 表名称 WHERE 列 运算符 值</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-9cf31d13fc46726f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="常用的运算符.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 查看学生ID是105的学生信息</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_id = <span class="number">105</span>;</div><div class="line"></div><div class="line"><span class="comment">-- 查看学生ID不是105的其他学生信息</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_id &lt;&gt; <span class="number">105</span> ;</div><div class="line"></div><div class="line"><span class="comment">-- 查看学生ID在103和108之间的学生信息</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_id <span class="keyword">between</span> <span class="number">103</span> <span class="keyword">and</span> <span class="number">108</span>;</div></pre></td></tr></table></figure>
<p>这里还有一个操作符很常用，就是 in 和 not in。<br>in 表示在多个值中存在，加上not则表示不存在<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 查看学生ID是103,105，,107的学生信息</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_id <span class="keyword">in</span> (<span class="number">103</span>,<span class="number">105</span>,<span class="number">107</span>);</div><div class="line"></div><div class="line"><span class="comment">-- 查看学生ID不在102中的其他学生信息</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">102</span>);</div></pre></td></tr></table></figure></p>
<h3 id="like"><a href="#like" class="headerlink" title="like"></a>like</h3><p>匹配字符串，像‘xxxx’一样</p>
<blockquote>
<p>%： 表示任意个或多个字符<br>_：表示任意单个字符</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 查看喜欢吃肉的学生信息</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_hobby <span class="keyword">like</span> <span class="string">'吃肉%'</span>;</div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> s_hobby <span class="keyword">like</span> <span class="string">'%吃肉%'</span>;</div></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/76024-fcf94f5dcf94cf4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="like使用"></p>
<h3 id="and-和-or"><a href="#and-和-or" class="headerlink" title="and 和 or"></a>and 和 or</h3><p>上面，我们都是一个单独的过滤条件，实际上，我们的会有各种各样的情况，需要同时满足多种过滤条件，这就用到了 and 和 or。</p>
<blockquote>
<p>AND 和 OR 可在 WHERE 子语句中把两个或多个条件结合起来。<br>如果第一个条件和第二个条件都成立，则 AND 运算符显示一条记录。<br>如果第一个条件和第二个条件中只要有一个成立，则 OR 运算符显示一条记录。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 查看班级ID是901的所有男生信息</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> c_id=<span class="number">901</span> <span class="keyword">and</span> s_gender=<span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="comment">-- 查看班级ID是901或者s_id大于107的学生信息</span></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> t_student <span class="keyword">where</span> c_id=<span class="number">901</span> <span class="keyword">or</span> s_id &gt; <span class="number">107</span>;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;MySQL&lt;br&gt;基本语法介绍&lt;/p&gt;
&lt;h2 id=&quot;1-什么是SQL&quot;&gt;&lt;a href=&quot;#1-什么是SQL&quot; class=&quot;headerlink&quot; title=&quot;1. 什么是SQL&quot;&gt;&lt;/a&gt;1. 什么是SQL&lt;/h2&gt;&lt;p&gt;SQL（Structured Query Language）结构化查询语言，通过SQL，我们就可以查询数据库中的数据，而数据再数据库中又是以表的形式保存的，所以SQL查询，主要就是对表进行查询。&lt;/p&gt;
&lt;p&gt;SQL的语法就和学习英语的语法、汉语拼音一样，满足给定的套路，去使用就可以了。&lt;/p&gt;
&lt;p&gt;当我们拿到了数据库的连接信息，连接到一个数据库上，我们就可以开始写SQL了。&lt;/p&gt;
&lt;h2 id=&quot;2-Navicat的使用&quot;&gt;&lt;a href=&quot;#2-Navicat的使用&quot; class=&quot;headerlink&quot; title=&quot;2. Navicat的使用&quot;&gt;&lt;/a&gt;2. Navicat的使用&lt;/h2&gt;&lt;p&gt;MySQL的客户端有很多，通常使用的，可能有Navicat，还有MySQL自带的workbench。&lt;br&gt;Navicat是收费产品，但在网上可以找到XX版，workbench是免费的。&lt;/p&gt;
&lt;p&gt;这里以Navicat为例，简单介绍下。&lt;br&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/76024-c7a0409bf6b9a087.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;菜单-新建连接&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/76024-4e9a9e1bce14c574.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;新建连接&quot;&gt;&lt;br&gt;在这里，输入数据库地址、用户名、密码等等就行了。&lt;/p&gt;
&lt;p&gt;这一个一个圆柱形的，就是一个数据库实例，下面那些电子表格图标的就是表，数据就存储在表中。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://upload-images.jianshu.io/upload_images/76024-cfabf6503b213d37.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;数据库及表&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/categories/MySQL/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="MySQL" scheme="https://yuguiyang.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>读书笔记-数据分析实战(3章)</title>
    <link href="https://yuguiyang.github.io/2017/09/04/reading_notes_data_analysis_02/"/>
    <id>https://yuguiyang.github.io/2017/09/04/reading_notes_data_analysis_02/</id>
    <published>2017-09-04T15:59:00.000Z</published>
    <updated>2017-09-04T16:15:27.777Z</updated>
    
    <content type="html"><![CDATA[<p>读书笔记</p>
<blockquote>
<p>《数据分析实战》 </p>
</blockquote>
<p>从第3章开始，都是从一个实际问题出发，套用，前面的数据分析思路，来进行模拟分析。<br>第3章的主题是“销售额为什么会减少？”：一款社交游戏本月的销售额相较于上月有所下滑，于是想调查下滑的原因，来提升销售额。</p>
<h2 id="现状和预期"><a href="#现状和预期" class="headerlink" title="现状和预期"></a>现状和预期</h2><p>现状肯定是当月销售额下降，预期肯定是保持上升，等于甚至高于上月销售额，这里的话，要确定销售额下降是不是一个问题，因为该社交游戏一直保持稳定增长，所以突然下滑，一定是不正常的， 是一个问题。</p>
<h2 id="发现问题"><a href="#发现问题" class="headerlink" title="发现问题"></a>发现问题</h2><p>我们明确了现状和预期，需要从中，找出影响最大的因素。<br>上面说到，有3种方法去发现问题：</p>
<ul>
<li>观察数据大小</li>
<li>数据分解（指标拆解）</li>
<li>数据对比</li>
</ul>
<p>这一步，也是一个根据经验来提出假设的过程，我们需要从宏观角度，找到可能影响销售额的因素。<br>我感觉，这一步是数据分析切入的点，比较重要，如果这一步没有发现核心问题，那后面的数据收集和分析都会有问题。</p>
<p>书中，在这一步，提出的问题是“商业宣传上存在问题”，对了，这一步，还需要及时和其他部门去沟通，像这种市场推广、商业宣传，本身我们可能不知道，所以，假设后要去确认是否有这样的情况。</p>
<a id="more"></a>
<h2 id="数据的收集和加工"><a href="#数据的收集和加工" class="headerlink" title="数据的收集和加工"></a>数据的收集和加工</h2><h2 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h2><h2 id="解决对策"><a href="#解决对策" class="headerlink" title="解决对策"></a>解决对策</h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;读书笔记&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;《数据分析实战》 &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;从第3章开始，都是从一个实际问题出发，套用，前面的数据分析思路，来进行模拟分析。&lt;br&gt;第3章的主题是“销售额为什么会减少？”：一款社交游戏本月的销售额相较于上月有所下滑，于是想调查下滑的原因，来提升销售额。&lt;/p&gt;
&lt;h2 id=&quot;现状和预期&quot;&gt;&lt;a href=&quot;#现状和预期&quot; class=&quot;headerlink&quot; title=&quot;现状和预期&quot;&gt;&lt;/a&gt;现状和预期&lt;/h2&gt;&lt;p&gt;现状肯定是当月销售额下降，预期肯定是保持上升，等于甚至高于上月销售额，这里的话，要确定销售额下降是不是一个问题，因为该社交游戏一直保持稳定增长，所以突然下滑，一定是不正常的， 是一个问题。&lt;/p&gt;
&lt;h2 id=&quot;发现问题&quot;&gt;&lt;a href=&quot;#发现问题&quot; class=&quot;headerlink&quot; title=&quot;发现问题&quot;&gt;&lt;/a&gt;发现问题&lt;/h2&gt;&lt;p&gt;我们明确了现状和预期，需要从中，找出影响最大的因素。&lt;br&gt;上面说到，有3种方法去发现问题：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;观察数据大小&lt;/li&gt;
&lt;li&gt;数据分解（指标拆解）&lt;/li&gt;
&lt;li&gt;数据对比&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这一步，也是一个根据经验来提出假设的过程，我们需要从宏观角度，找到可能影响销售额的因素。&lt;br&gt;我感觉，这一步是数据分析切入的点，比较重要，如果这一步没有发现核心问题，那后面的数据收集和分析都会有问题。&lt;/p&gt;
&lt;p&gt;书中，在这一步，提出的问题是“商业宣传上存在问题”，对了，这一步，还需要及时和其他部门去沟通，像这种市场推广、商业宣传，本身我们可能不知道，所以，假设后要去确认是否有这样的情况。&lt;/p&gt;
    
    </summary>
    
      <category term="读书笔记" scheme="https://yuguiyang.github.io/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="数据分析" scheme="https://yuguiyang.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
      <category term="读书笔记" scheme="https://yuguiyang.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
      <category term="实例" scheme="https://yuguiyang.github.io/tags/%E5%AE%9E%E4%BE%8B/"/>
    
  </entry>
  
  <entry>
    <title>数据分析案例-购物篮分析</title>
    <link href="https://yuguiyang.github.io/2017/09/01/data-analyst-method-01/"/>
    <id>https://yuguiyang.github.io/2017/09/01/data-analyst-method-01/</id>
    <published>2017-09-01T01:11:00.000Z</published>
    <updated>2017-09-01T02:36:46.335Z</updated>
    
    <content type="html"><![CDATA[<p>数据分析案例</p>
<blockquote>
<p>说到数据分析、数据挖掘，我们首先想到的可能就是沃尔玛那个“啤酒与尿布”的故事，它告诉我们，世间万物都有着千丝万缕的联系。这其中使用的数据分析方法就是“关联分析”。</p>
</blockquote>
<h1 id="什么是购物篮分析"><a href="#什么是购物篮分析" class="headerlink" title="什么是购物篮分析"></a>什么是购物篮分析</h1><p>购物篮分析（Market Basket Analysis），购物篮就是我们去超市使用的篮子，结账的时候，购物篮中所有的商品都会被一起结算。所谓的购物篮分析就是通过购物篮子所反应的信息来==研究顾客的购买行为==</p>
<a id="more"></a>
<p>关联分析要解决的问题是：一群用户购买了很多产品之后，哪些产品同时购买的几率比较高？买A产品的同时，买哪个产品的几率比较高</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-method-01.png-blog.photo" alt="data-analyst-method-01-01"></p>
<p>这里介绍完概念，暂时还没啥写的，后面再补充下怎样实现，这里会有一个Tableau的简单购物篮分析。</p>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p>上文的部分理论知识，摘自下面的博客</p>
<p><a href="http://www.17bigdata.com/%E5%A4%9A%E8%A7%92%E5%BA%A6%E7%9C%8B%E6%95%B0%E6%8D%AE%E6%8C%96%E6%8E%98%E7%BB%8F%E5%85%B8%E6%A1%88%E4%BE%8B-%E8%B4%AD%E7%89%A9%E7%AF%AE%E5%88%86%E6%9E%90.html" target="_blank" rel="external">一起大数据</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;数据分析案例&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;说到数据分析、数据挖掘，我们首先想到的可能就是沃尔玛那个“啤酒与尿布”的故事，它告诉我们，世间万物都有着千丝万缕的联系。这其中使用的数据分析方法就是“关联分析”。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;什么是购物篮分析&quot;&gt;&lt;a href=&quot;#什么是购物篮分析&quot; class=&quot;headerlink&quot; title=&quot;什么是购物篮分析&quot;&gt;&lt;/a&gt;什么是购物篮分析&lt;/h1&gt;&lt;p&gt;购物篮分析（Market Basket Analysis），购物篮就是我们去超市使用的篮子，结账的时候，购物篮中所有的商品都会被一起结算。所谓的购物篮分析就是通过购物篮子所反应的信息来==研究顾客的购买行为==&lt;/p&gt;
    
    </summary>
    
      <category term="数据分析" scheme="https://yuguiyang.github.io/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
    
      <category term="数据分析" scheme="https://yuguiyang.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
      <category term="购物篮分析" scheme="https://yuguiyang.github.io/tags/%E8%B4%AD%E7%89%A9%E7%AF%AE%E5%88%86%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>读书笔记-数据分析实战(1、2章)</title>
    <link href="https://yuguiyang.github.io/2017/09/01/reading_notes_data_analysis_01/"/>
    <id>https://yuguiyang.github.io/2017/09/01/reading_notes_data_analysis_01/</id>
    <published>2017-08-31T16:59:00.000Z</published>
    <updated>2017-09-04T15:43:55.134Z</updated>
    
    <content type="html"><![CDATA[<p> 读书笔记</p>
<blockquote>
<p>《数据分析实战》 </p>
</blockquote>
<h1 id="1-什么是数据科学家"><a href="#1-什么是数据科学家" class="headerlink" title="1. 什么是数据科学家"></a>1. 什么是数据科学家</h1><p>书中通过“什么是数据”和“数据在商业中的应用”，推导出数据科学家的定义。</p>
<blockquote>
<p>人们通过观测数据来推测出某种因果关系，再用这种因果关系来预测未来或者控制原因以达到预期的结果。把从事这种工作的人成为数据科学家。<br>– 书中摘录</p>
</blockquote>
<p>上面的定义觉得不是很清晰，就百度上找了找：</p>
<blockquote>
<p>数据科学家是指能采用科学方法、运用数据挖掘工具对复杂多量的数字、符号、文字、网址、音频或视频等信息进行数字化重现与认识，并能寻找新的数据洞察的工程师或专家(不同于统计学家或分析师)。一个优秀的数据科学家需要具备的素质有：懂数据采集、懂数学算法、懂数学软件、懂数据分析、懂预测分析、懂市场应用、懂决策分析等。<br>– 百度百科</p>
</blockquote>
<p>我觉得数据科学家就是对于数据相关的所有门类都有一个整体的认识，感觉是个“杂家”，精通算法、什么深度学习、机器学习、AI之类的都是信手拈来，对我就是神一样的存在了，努力吧，同学。</p>
<a id="more"></a>
<h1 id="2-3中类型的数据科学家"><a href="#2-3中类型的数据科学家" class="headerlink" title="2. 3中类型的数据科学家"></a>2. 3中类型的数据科学家</h1><p>书中将数据科学家分成了3类，主要从所在领域分类：</p>
<ul>
<li>商业领域出身</li>
<li>统计学出身</li>
<li>工程领域出身</li>
</ul>
<p>这应该也是数据科学家成长的3条路线，从不同的路线出发，最终殊途同归。当然，这3个领域需要综合，才称得上是合格的数据科学家。</p>
<p>书中的技能配图，可以瞻仰下</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/reading_notes_data_analysis_01_01.png-blog.photo" alt="reading_notes_data_analysis_01_01.png"></p>
<h1 id="数据分析的5个流程"><a href="#数据分析的5个流程" class="headerlink" title="数据分析的5个流程"></a>数据分析的5个流程</h1><p>书中，将数据分析分为5个步骤，看完后，感觉很靠谱，真的很实用，这里分享下</p>
<p>商业数据分析的目的是解决问题，要解决问题，需要使用统计分析、机器学习、数据挖掘等各种方法。</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/reading_notes_data_analysis_01_02.png-blog.photo" alt="reading_notes_data_analysis_01_02.png"></p>
<h2 id="现状和预期"><a href="#现状和预期" class="headerlink" title="现状和预期"></a>现状和预期</h2><p>首先我们要确认“什么才是数据分析中的问题”。<br>比如，“某种商品销售额下降”，这是一个现象，但它是不是一个问题呢？<br>如果，该产品不是公司主打商品，并且就要下架了，那销售额下降并不是一个问题，或者，该商品处于正常的波动，或是季节、市场环境的外部因素导致的，可能都不是一个问题；<br>相反，如果该商品是公司主打商品，并且没有其他外部因素导致，那销售额下降就是个问题了。</p>
<p>这里记录下，其实，还需要确认下，销售额取数逻辑是否有问题，确保数据没有问题，并且要知道这个下降是怎么定义的，是和什么商品，或时间段对比发现下降的。</p>
<p>有对比，才会有差距，既然下降了，说明他心里一定有个预期，即现状和预期之间是有差距的</p>
<h2 id="发现问题"><a href="#发现问题" class="headerlink" title="发现问题"></a>发现问题</h2><p>有了上面的“现状和预期”，我们需要区别”现象和问题“。<br>像“销售额下降”，“顾客流失”，这都是一个现象，我们需要从中去发现问题</p>
<table>
<thead>
<tr>
<th>现象</th>
<th>前提</th>
<th>预期</th>
<th>是否有问题</th>
</tr>
</thead>
<tbody>
<tr>
<td>销售额下降</td>
<td>销售额比例低</td>
<td>维持现状</td>
<td>无</td>
</tr>
<tr>
<td>销售额下降</td>
<td>销售额比例高</td>
<td>将销售额恢复到良好状态</td>
<td>有</td>
</tr>
<tr>
<td>销售额上升</td>
<td>广告费用高</td>
<td>降低广告费用</td>
<td>有</td>
</tr>
<tr>
<td>销售额上升</td>
<td>广告费用适当</td>
<td>维持现状</td>
<td>无</td>
</tr>
</tbody>
</table>
<h3 id="从3个角度发现问题"><a href="#从3个角度发现问题" class="headerlink" title="从3个角度发现问题"></a>从3个角度发现问题</h3><p>发现问题的关键是思考并理解现状和预期之间的差距。<br>那怎样发现、理解这个差距呢？</p>
<h4 id="观察数据大小"><a href="#观察数据大小" class="headerlink" title="观察数据大小"></a>观察数据大小</h4><p>首先考虑有哪些因素会导致这些差距，并明确这些因素的影响程度大小，即找到影响最大的因素。</p>
<h4 id="将数据分解后观察"><a href="#将数据分解后观察" class="headerlink" title="将数据分解后观察"></a>将数据分解后观察</h4><p>指从多个角度观察发生的现象，分解出构成这种现象的因素。在分解的时候，必须遵循MECE原则：</p>
<ul>
<li>Mutually 相互性</li>
<li>Exclusive 排重性</li>
<li>Collectively 完整性</li>
<li>Exhaustive 全面性</li>
</ul>
<p>我感觉这个很抽象，不是很理解，书上有一个例子，说的还不错，<br>常用的拆分方法是因数分解，比如：</p>
<p>销售额=人均销售额*购买人数</p>
<p>拆解后，找到容易调控的因子，才方面后面去解决问题</p>
<h4 id="将数据比较后观察"><a href="#将数据比较后观察" class="headerlink" title="将数据比较后观察"></a>将数据比较后观察</h4><p>指的是将发生问题是的数据和没发生问题时的数据相互比较，并找出问题出现的原因。<br>比如，按时间对比，看看同比、环比（使用时间序列）</p>
<ul>
<li>昨天和今天比较</li>
<li>上周和本周比较</li>
<li><p>同一个商业活动前、后比较</p>
</li>
<li><p>与竞争对手数据比较</p>
</li>
<li><p>公司内部服务之间利益比较</p>
</li>
<li><p>年龄段差异</p>
</li>
<li>性别差异</li>
<li>地域差异</li>
</ul>
<h2 id="3-3-数据收集和整理"><a href="#3-3-数据收集和整理" class="headerlink" title="3.3 数据收集和整理"></a>3.3 数据收集和整理</h2><p>通过前面，对现状和预期的对比，发现影响最大的因素后，我们就需要开始收集数据，来验证问题。<br>数据收集的话，还会涉及到怎样去采集数据，比如想要的数据，并没有保存下来。<br>已保存下来的数据，通常会保存在文件、数据库或者是Hadoop（HDFS）中<br>收集完数据，我们就需要对数据进行加工，变成我们后面分析需要的格式，比如使用SQL进行处理，或者Python、R进行整合；我们再加工数据的同时，为了方便我们后面的分析，可能还需要增加一下自定义的变量，比如一些标志位，像“已消费（1），未消费（0）”；或者是一些离散变量，类似于区间段：</p>
<ul>
<li>消费金额较大用户（1）</li>
<li>消费金额一般用户（2）</li>
<li>消费金额较小用户（3）</li>
</ul>
<h2 id="3-4-数据分析"><a href="#3-4-数据分析" class="headerlink" title="3.4 数据分析"></a>3.4 数据分析</h2><p>书中把数据分析按目的，分为两大类：“决策支持和自动化、最优化”。<br>其中，“决策支持”使用简单求和、交叉列表的方式分析，还会涉及预测模型；<br>“自动化、最优化”则涉及机器学习、构建算法。</p>
<h2 id="3-5-解决对策"><a href="#3-5-解决对策" class="headerlink" title="3.5 解决对策"></a>3.5 解决对策</h2><p>通过上面两种分析思路，我们需要针对分析的结果，来判断是否要采取对应的决策，不同的对策， 又会产生不同的沟通成本。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt; 读书笔记&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;《数据分析实战》 &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;1-什么是数据科学家&quot;&gt;&lt;a href=&quot;#1-什么是数据科学家&quot; class=&quot;headerlink&quot; title=&quot;1. 什么是数据科学家&quot;&gt;&lt;/a&gt;1. 什么是数据科学家&lt;/h1&gt;&lt;p&gt;书中通过“什么是数据”和“数据在商业中的应用”，推导出数据科学家的定义。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;人们通过观测数据来推测出某种因果关系，再用这种因果关系来预测未来或者控制原因以达到预期的结果。把从事这种工作的人成为数据科学家。&lt;br&gt;– 书中摘录&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;上面的定义觉得不是很清晰，就百度上找了找：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;数据科学家是指能采用科学方法、运用数据挖掘工具对复杂多量的数字、符号、文字、网址、音频或视频等信息进行数字化重现与认识，并能寻找新的数据洞察的工程师或专家(不同于统计学家或分析师)。一个优秀的数据科学家需要具备的素质有：懂数据采集、懂数学算法、懂数学软件、懂数据分析、懂预测分析、懂市场应用、懂决策分析等。&lt;br&gt;– 百度百科&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我觉得数据科学家就是对于数据相关的所有门类都有一个整体的认识，感觉是个“杂家”，精通算法、什么深度学习、机器学习、AI之类的都是信手拈来，对我就是神一样的存在了，努力吧，同学。&lt;/p&gt;
    
    </summary>
    
      <category term="读书笔记" scheme="https://yuguiyang.github.io/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
    
      <category term="数据分析" scheme="https://yuguiyang.github.io/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"/>
    
      <category term="读书笔记" scheme="https://yuguiyang.github.io/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
      <category term="实例" scheme="https://yuguiyang.github.io/tags/%E5%AE%9E%E4%BE%8B/"/>
    
  </entry>
  
  <entry>
    <title>SQL笔试题-连续登录天数</title>
    <link href="https://yuguiyang.github.io/2017/08/31/data-analyst-interview-sql-03/"/>
    <id>https://yuguiyang.github.io/2017/08/31/data-analyst-interview-sql-03/</id>
    <published>2017-08-31T05:11:00.000Z</published>
    <updated>2017-08-31T07:41:57.077Z</updated>
    
    <content type="html"><![CDATA[<p>SQL笔试题</p>
<blockquote>
<p>下面的SQL基于PostgreSQL</p>
</blockquote>
<h1 id="1-用户连续登录天数"><a href="#1-用户连续登录天数" class="headerlink" title="1.用户连续登录天数"></a>1.用户连续登录天数</h1><h2 id="背景描述"><a href="#背景描述" class="headerlink" title="背景描述"></a>背景描述</h2><p>现在我们有一张用户登录日志表，记录用户每天的登录时间，我们想要统计一下，用户每次连续登录的开始日期和结束日期，以及连续登录天数。</p>
<table>
<thead>
<tr>
<th>用户ID</th>
<th>登录日期</th>
</tr>
</thead>
<tbody>
<tr>
<td>1001</td>
<td>2017-01-01</td>
</tr>
<tr>
<td>1001</td>
<td>2017-01-02</td>
</tr>
<tr>
<td>1001</td>
<td>2017-01-04</td>
</tr>
<tr>
<td>1001</td>
<td>2017-01-06</td>
</tr>
<tr>
<td>1002</td>
<td>2017-01-02</td>
</tr>
<tr>
<td>1002</td>
<td>2017-01-03</td>
</tr>
</tbody>
</table>
<p>同学们先思考下，整理下思路，如果没有思路或者某几个点不了解，就可以继续往下看了。</p>
<a id="more"></a>
<h2 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> interview.tm_login_log</div><div class="line">(</div><div class="line">  user_id <span class="built_in">integer</span>,</div><div class="line">  login_date <span class="built_in">date</span></div><div class="line">)</div><div class="line"><span class="keyword">WITH</span> (</div><div class="line">  OIDS=<span class="literal">FALSE</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">-- 这里的数据是最简化的情况，每个用户每天只有一条登录信息，</span></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-01'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-02'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-04'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-05'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-06'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-07'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-08'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-09'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-10'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-12'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-13'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-15'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">'2017-01-16'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-01'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-02'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-03'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-04'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-05'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-06'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-07'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-08'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-09'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-10'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-11'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-12'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-13'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-16'</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_login_log <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">'2017-01-17'</span>);</div></pre></td></tr></table></figure>
<h2 id="步骤拆解"><a href="#步骤拆解" class="headerlink" title="步骤拆解"></a>步骤拆解</h2><p>我们首先要思考，怎样才算连续登录呢？就是1号登录，2号也登录了，这样就连续2天登录，那我们怎么知道2号他有没有登录呢？<br>一种思路是根据排序来判断：<br>我们来根据日期来排个名<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	user_id,</div><div class="line">	login_date,</div><div class="line">	row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_id <span class="keyword">order</span> <span class="keyword">by</span> login_date) day_rank</div><div class="line"><span class="keyword">from</span> </div><div class="line">	interview.tm_login_log</div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-03-01.png-blog.photo" alt="data-analyst-interview-sql-03-01"></p>
<p>现在，我们根据用户ID，对他的登录日期做了排序，但是我们还是没有办法知道，他是不是连续的。<br>我们根据这个排序再思考一下，对于一个用户来说，他的登录日期排序已经是连续的了，如果登录日期也是个数字，那我们根据每行的差值，就可以判断登录日期是否连续了。<br>我们换个角度，我们找一个起始日期，来计算一个相差的天数，用它去和排序相对比，就可以了。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	user_id,</div><div class="line">	login_date,</div><div class="line">	date_part(<span class="string">'day'</span>,login_date::<span class="keyword">timestamp</span> - <span class="keyword">timestamp</span><span class="string">'2017-01-01'</span>) day_interval, <span class="comment">-- 间隔天数</span></div><div class="line">	row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_id <span class="keyword">order</span> <span class="keyword">by</span> login_date) day_rank <span class="comment">-- 日期排序</span></div><div class="line"><span class="keyword">from</span> </div><div class="line">	interview.tm_login_log</div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-03-02.png-blog.photo" alt="data-analyst-interview-sql-03-02"></p>
<p>我们观察下数据，因为日期排序是连续的，我们统计的间隔天数都是一个起始日期，所以，如果登录日期是连续的，那么，排序-间隔天数的差值也应该是一样的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	user_id,</div><div class="line">	login_date,</div><div class="line">	date_part(<span class="string">'day'</span>,login_date::<span class="keyword">timestamp</span> - <span class="keyword">timestamp</span><span class="string">'2017-01-01'</span>) day_interval, <span class="comment">-- 间隔天数</span></div><div class="line">	row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_id <span class="keyword">order</span> <span class="keyword">by</span> login_date) day_rank, <span class="comment">-- 日期排序</span></div><div class="line">	(</div><div class="line">		row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_id <span class="keyword">order</span> <span class="keyword">by</span> login_date)</div><div class="line">	) - (</div><div class="line">		date_part(<span class="string">'day'</span>,login_date::<span class="keyword">timestamp</span> - <span class="keyword">timestamp</span><span class="string">'2017-01-01'</span>)</div><div class="line">	) diff_value</div><div class="line"><span class="keyword">from</span> </div><div class="line">	interview.tm_login_log</div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-03-03.png-blog.photo" alt="data-analyst-interview-sql-03-03"></p>
<p>差值一样的记录，就是连续登录的日期</p>
<p>好了，连续登录的判断标准，我们已经确定了，下面就是把题目中要的数据查出来即可<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">select</span> </div><div class="line">	user_id,</div><div class="line">	<span class="comment">--diff_value, --差值</span></div><div class="line">	<span class="keyword">min</span>(login_date) start_date, <span class="comment">--开始日期</span></div><div class="line">	<span class="keyword">max</span>(login_date) end_date, <span class="comment">--结束日期</span></div><div class="line">	<span class="keyword">count</span>(<span class="number">1</span>) running_days <span class="comment">--连续登录天数</span></div><div class="line"><span class="keyword">from</span> (</div><div class="line">	<span class="keyword">select</span> </div><div class="line">		user_id,</div><div class="line">		login_date,</div><div class="line">		date_part(<span class="string">'day'</span>,login_date::<span class="keyword">timestamp</span> - <span class="keyword">timestamp</span><span class="string">'2017-01-01'</span>) day_interval, <span class="comment">-- 间隔天数</span></div><div class="line">		row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_id <span class="keyword">order</span> <span class="keyword">by</span> login_date) day_rank, <span class="comment">-- 日期排序</span></div><div class="line">		(</div><div class="line">			row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_id <span class="keyword">order</span> <span class="keyword">by</span> login_date)</div><div class="line">		) - (</div><div class="line">			date_part(<span class="string">'day'</span>,login_date::<span class="keyword">timestamp</span> - <span class="keyword">timestamp</span><span class="string">'2017-01-01'</span>)</div><div class="line">		) diff_value</div><div class="line">	<span class="keyword">from</span> </div><div class="line">		interview.tm_login_log</div><div class="line">) base</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span> user_id,diff_value</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> user_id,start_date</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-03-05.png-blog.photo" alt="data-analyst-interview-sql-03-05"></p>
<h3 id="拓展：获取用户最大的连续登录天数及开始日期和结束日期"><a href="#拓展：获取用户最大的连续登录天数及开始日期和结束日期" class="headerlink" title="拓展：获取用户最大的连续登录天数及开始日期和结束日期"></a>拓展：获取用户最大的连续登录天数及开始日期和结束日期</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">with tmp as (</div><div class="line"><span class="keyword">select</span> </div><div class="line">	user_id,</div><div class="line">	diff_value, <span class="comment">--差值</span></div><div class="line">	<span class="keyword">min</span>(login_date) start_date, <span class="comment">--开始日期</span></div><div class="line">	<span class="keyword">max</span>(login_date) end_date, <span class="comment">--结束日期</span></div><div class="line">	<span class="keyword">count</span>(<span class="number">1</span>) running_days <span class="comment">--连续登录天数</span></div><div class="line"><span class="keyword">from</span> (</div><div class="line">	<span class="keyword">select</span> </div><div class="line">		user_id,</div><div class="line">		login_date,</div><div class="line">		date_part(<span class="string">'day'</span>,login_date::<span class="keyword">timestamp</span> - <span class="keyword">timestamp</span><span class="string">'2017-01-01'</span>) day_interval, <span class="comment">-- 间隔天数</span></div><div class="line">		row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_id <span class="keyword">order</span> <span class="keyword">by</span> login_date) day_rank, <span class="comment">-- 日期排序</span></div><div class="line">		(</div><div class="line">			row_number() <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> user_id <span class="keyword">order</span> <span class="keyword">by</span> login_date)</div><div class="line">		) - (</div><div class="line">			date_part(<span class="string">'day'</span>,login_date::<span class="keyword">timestamp</span> - <span class="keyword">timestamp</span><span class="string">'2017-01-01'</span>)</div><div class="line">		) diff_value</div><div class="line">	<span class="keyword">from</span> </div><div class="line">		interview.tm_login_log</div><div class="line">) base</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span> user_id,diff_value</div><div class="line">) </div><div class="line"><span class="keyword">select</span> </div><div class="line">	a.user_id,a.start_date,a.end_date,a.running_days</div><div class="line"><span class="keyword">from</span> </div><div class="line">	tmp a</div><div class="line"><span class="keyword">join</span> (</div><div class="line">	<span class="keyword">select</span> user_id,<span class="keyword">max</span>(running_days) running_days <span class="keyword">from</span> tmp <span class="keyword">group</span> <span class="keyword">by</span> user_id</div><div class="line">) b <span class="keyword">on</span> a.user_id = b.user_id</div><div class="line"><span class="keyword">and</span> a.running_days = b.running_days</div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-03-04.png-blog.photo" alt="data-analyst-interview-sql-03-04"></p>
<h3 id="连续5天登录用户"><a href="#连续5天登录用户" class="headerlink" title="连续5天登录用户"></a>连续5天登录用户</h3><p>这里补充另一个类似的问题，这里，我们想看连续登录5天的用户，使用上面的方法可以实现，这里介绍一个更快的方法：<br>是使用一个函数<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">向前取n位</div><div class="line">lag(value anyelement [, offset integer [, default anyelement ]])</div><div class="line"></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> (</div><div class="line">	<span class="keyword">select</span> </div><div class="line">		a.user_id,</div><div class="line">		a.login_date,</div><div class="line">		<span class="comment">--5天前的登录日期</span></div><div class="line">		lag(a.login_date,<span class="number">4</span>) <span class="keyword">over</span>(<span class="keyword">partition</span> <span class="keyword">by</span> a.user_id <span class="keyword">order</span> <span class="keyword">by</span> a.login_date) pre_five_day </div><div class="line">	<span class="keyword">from</span> interview.tm_login_log a </div><div class="line">)x</div><div class="line"><span class="keyword">where</span> date_part(<span class="string">'day'</span>,x.login_date::<span class="keyword">timestamp</span> - pre_five_day::<span class="keyword">timestamp</span>)=<span class="number">4</span></div></pre></td></tr></table></figure></p>
<p>这样取连续登录的话，比较方便</p>
<h3 id="思考题：连续7天未登录用户"><a href="#思考题：连续7天未登录用户" class="headerlink" title="思考题：连续7天未登录用户"></a>思考题：连续7天未登录用户</h3><p>这里留一个类似的小问题，大家自行练习下</p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>我们简单整理下思路，上面的例子，我认为主要是一个思路的介绍，核心就是我们要找到一个判断连续的方法，找到方法后，SQL自然就一步一步想出来了。<br>上面只是一种思路，一定还有更优的解法，欢迎大家反馈分享。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;SQL笔试题&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;下面的SQL基于PostgreSQL&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;1-用户连续登录天数&quot;&gt;&lt;a href=&quot;#1-用户连续登录天数&quot; class=&quot;headerlink&quot; title=&quot;1.用户连续登录天数&quot;&gt;&lt;/a&gt;1.用户连续登录天数&lt;/h1&gt;&lt;h2 id=&quot;背景描述&quot;&gt;&lt;a href=&quot;#背景描述&quot; class=&quot;headerlink&quot; title=&quot;背景描述&quot;&gt;&lt;/a&gt;背景描述&lt;/h2&gt;&lt;p&gt;现在我们有一张用户登录日志表，记录用户每天的登录时间，我们想要统计一下，用户每次连续登录的开始日期和结束日期，以及连续登录天数。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;用户ID&lt;/th&gt;
&lt;th&gt;登录日期&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;1001&lt;/td&gt;
&lt;td&gt;2017-01-01&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1001&lt;/td&gt;
&lt;td&gt;2017-01-02&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1001&lt;/td&gt;
&lt;td&gt;2017-01-04&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1001&lt;/td&gt;
&lt;td&gt;2017-01-06&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1002&lt;/td&gt;
&lt;td&gt;2017-01-02&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1002&lt;/td&gt;
&lt;td&gt;2017-01-03&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;同学们先思考下，整理下思路，如果没有思路或者某几个点不了解，就可以继续往下看了。&lt;/p&gt;
    
    </summary>
    
      <category term="笔试题" scheme="https://yuguiyang.github.io/categories/%E7%AC%94%E8%AF%95%E9%A2%98/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="笔试题" scheme="https://yuguiyang.github.io/tags/%E7%AC%94%E8%AF%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>SQL笔试题-行转列</title>
    <link href="https://yuguiyang.github.io/2017/08/28/data-analyst-interview-sql-02/"/>
    <id>https://yuguiyang.github.io/2017/08/28/data-analyst-interview-sql-02/</id>
    <published>2017-08-28T05:11:00.000Z</published>
    <updated>2017-08-28T05:54:30.181Z</updated>
    
    <content type="html"><![CDATA[<p>SQL笔试题</p>
<blockquote>
<p>下面的SQL基于PostgreSQL</p>
</blockquote>
<h1 id="1-行转列"><a href="#1-行转列" class="headerlink" title="1. 行转列"></a>1. 行转列</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>我们写SQL的时候，经常会遇到一些列转行、行转列的情况，有的时候是为了展现需要，有的时候是代码里就得这样转一下。总之嘞，得掌握这个技巧。下面就开始我们的练习。</p>
<h2 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> interview.tm_score</div><div class="line">(</div><div class="line">  stu_name <span class="built_in">character</span> <span class="built_in">varying</span>(<span class="number">20</span>), <span class="comment">-- 学生名称</span></div><div class="line">  course_name <span class="built_in">character</span> <span class="built_in">varying</span>(<span class="number">20</span>), <span class="comment">-- 课程名称</span></div><div class="line">  score <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="comment">-- 分数</span></div><div class="line">)</div><div class="line"><span class="keyword">WITH</span> (</div><div class="line">  OIDS=<span class="literal">FALSE</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">-- 初始化数据</span></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_score <span class="keyword">values</span>(<span class="string">'路飞'</span>,<span class="string">'数学'</span>,<span class="number">100</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_score <span class="keyword">values</span>(<span class="string">'路飞'</span>,<span class="string">'语文'</span>,<span class="number">62</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_score <span class="keyword">values</span>(<span class="string">'路飞'</span>,<span class="string">'英语'</span>,<span class="number">98</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_score <span class="keyword">values</span>(<span class="string">'索隆'</span>,<span class="string">'数学'</span>,<span class="number">40</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_score <span class="keyword">values</span>(<span class="string">'索隆'</span>,<span class="string">'语文'</span>,<span class="number">57</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_score <span class="keyword">values</span>(<span class="string">'索隆'</span>,<span class="string">'英语'</span>,<span class="number">40</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_score <span class="keyword">values</span>(<span class="string">'娜美'</span>,<span class="string">'数学'</span>,<span class="number">42</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_score <span class="keyword">values</span>(<span class="string">'娜美'</span>,<span class="string">'语文'</span>,<span class="number">44</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> interview.tm_score <span class="keyword">values</span>(<span class="string">'娜美'</span>,<span class="string">'英语'</span>,<span class="number">28</span>);</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-02-01.png-blog.photo" alt="data-analyst-interview-sql-02-01"></p>
<a id="more"></a>
<p>我们先来思考第一个问题：<br>我们怎样可以将课程变成列呢，类似交叉表那样？<br>最容易想到的方法，就是使用case when了</p>
<h3 id="case-when"><a href="#case-when" class="headerlink" title="case when"></a>case when</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	stu_name,</div><div class="line">	<span class="keyword">max</span>(<span class="keyword">case</span> course_name <span class="keyword">when</span> <span class="string">'数学'</span> <span class="keyword">then</span> score <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">"数学"</span>, </div><div class="line">	<span class="keyword">max</span>(<span class="keyword">case</span> course_name <span class="keyword">when</span> <span class="string">'语文'</span> <span class="keyword">then</span> score <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">"语文"</span>, </div><div class="line">	<span class="keyword">max</span>(<span class="keyword">case</span> course_name <span class="keyword">when</span> <span class="string">'英语'</span> <span class="keyword">then</span> score <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>) <span class="keyword">as</span> <span class="string">"英语"</span></div><div class="line">	</div><div class="line"><span class="keyword">from</span> </div><div class="line">	interview.tm_score</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span> </div><div class="line">	stu_name</div><div class="line">;</div></pre></td></tr></table></figure>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-02-02.png-blog.photo" alt="data-analyst-interview-sql-02-02"></p>
<h3 id="crosstab"><a href="#crosstab" class="headerlink" title="crosstab"></a>crosstab</h3><p>在新版本的PostgreSQL中有一个extension，可以方便的实现行转列<br>我们需要先安装这个扩展，我看了下，PostgreSQL8.3以后的版本都可以安装<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">create</span> extension tablefunc</div></pre></td></tr></table></figure></p>
<blockquote>
<p>官网地址：<a href="https://www.postgresql.org/docs/9.5/static/tablefunc.html" target="_blank" rel="external">https://www.postgresql.org/docs/9.5/static/tablefunc.html</a></p>
</blockquote>
<p>安装完后，会有这么几个函数</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-02-03.png-blog.photo" alt="data-analyst-interview-sql-02-03"></p>
<p>我们可以使用crosstab来实现上面的行转列<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> crosstab(</div><div class="line">	<span class="string">'select stu_name,course_name,score from interview.tm_score'</span></div><div class="line">) <span class="keyword">as</span> ct(stu_name <span class="built_in">varchar</span>(<span class="number">20</span>) ,<span class="string">"数学"</span> <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>),<span class="string">"语文"</span> <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>), <span class="string">"英语"</span> <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>))</div></pre></td></tr></table></figure></p>
<p>结果也是一样的，我们传入一个SQL，SQL里面返回3列（这3列都是默认处理的，第一列是主字段，第2列是要拆成列的字段，第3列是要显示的值），最后因为返回值是record，所以我们要定义一下类型。</p>
<p>这里，顺便看看这个函数的用法</p>
<h4 id="要转成列的字段有Null"><a href="#要转成列的字段有Null" class="headerlink" title="要转成列的字段有Null"></a>要转成列的字段有Null</h4><p>是这样一种情况：不是所有的同学都有3门课程的分数<br>我们删掉了几条记录来模拟<br><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-02-04.png-blog.photo" alt="data-analyst-interview-sql-02-04"></p>
<p>这时候使用crosstab，结果会有问题</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-02-05.png-blog.photo" alt="data-analyst-interview-sql-02-05"></p>
<p>数据会自动从第一列开始，导致错误的数据<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- crosstab(text source_sql, text category_sql)</span></div><div class="line"></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> crosstab(</div><div class="line">	<span class="string">'select stu_name,course_name,score from interview.tm_score'</span>,<span class="string">'select distinct course_name from interview.tm_score'</span></div><div class="line">) <span class="keyword">as</span> ct(stu_name <span class="built_in">varchar</span>(<span class="number">20</span>) ,<span class="string">"数学"</span> <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>),<span class="string">"语文"</span> <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>), <span class="string">"英语"</span> <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>))</div></pre></td></tr></table></figure></p>
<p>这时候，数据就对了</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-02-06.png-blog.photo" alt="data-analyst-interview-sql-02-06"></p>
<h4 id="source-sql-多于3列"><a href="#source-sql-多于3列" class="headerlink" title="source_sql 多于3列"></a>source_sql 多于3列</h4><p>这种情况是，我们查询的结果不单单有上面说的3列，可能还有其他字段，<br>比如，我们可以在上面的测试数据上加一个班级列<br>我们同样也是使用上面的方式解决</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">alter</span> <span class="keyword">table</span> interview.tm_score <span class="keyword">add</span> <span class="keyword">column</span> stu_class <span class="built_in">varchar</span>(<span class="number">10</span>);</div><div class="line"></div><div class="line"><span class="keyword">update</span> interview.tm_score <span class="keyword">set</span> stu_class=<span class="string">'一班'</span> <span class="keyword">where</span> stu_name <span class="keyword">in</span> (<span class="string">'路飞'</span>,<span class="string">'索隆'</span>);</div><div class="line"><span class="keyword">update</span> interview.tm_score <span class="keyword">set</span> stu_class=<span class="string">'二班'</span> <span class="keyword">where</span> stu_name <span class="keyword">not</span> <span class="keyword">in</span> (<span class="string">'路飞'</span>,<span class="string">'索隆'</span>);</div><div class="line"></div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> crosstab(</div><div class="line">	<span class="string">'select stu_name,stu_class,course_name,score from interview.tm_score'</span>,<span class="string">'select distinct course_name from interview.tm_score'</span></div><div class="line">) <span class="keyword">as</span> ct(stu_name <span class="built_in">varchar</span>(<span class="number">20</span>) ,stu_class <span class="built_in">varchar</span>(<span class="number">10</span>),<span class="string">"数学"</span> <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>),<span class="string">"语文"</span> <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>), <span class="string">"英语"</span> <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>))</div></pre></td></tr></table></figure>
<blockquote>
<p>这里我们六个思考题，有这样一组数据：</p>
</blockquote>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-02-07.png-blog.photo" alt="data-analyst-interview-sql-02-07"></p>
<p>我们想查询出这样格式的数据</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-02-08.png-blog.photo" alt="data-analyst-interview-sql-02-08"></p>
<p>大家可以练习下这个SQL该怎么写</p>
<h1 id="列转行"><a href="#列转行" class="headerlink" title="列转行"></a>列转行</h1><p>我们可以把行转成列，那要怎样把列转成行呢？</p>
<h2 id="union-all"><a href="#union-all" class="headerlink" title="union all"></a>union all</h2><p>最简单的方法是直接union all,既然要放到一列里面，那字段类型肯定要一样，所以直接根据不同字段去union all 就好了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> stu_name,<span class="string">"数学"</span> <span class="keyword">from</span> xxx</div><div class="line"><span class="keyword">union</span> all </div><div class="line"><span class="keyword">select</span> stu_name,<span class="string">"语文"</span> <span class="keyword">from</span> xxx</div><div class="line"><span class="keyword">union</span> all</div><div class="line"><span class="keyword">select</span> stu_name,<span class="string">"英语"</span> <span class="keyword">from</span> xxx</div></pre></td></tr></table></figure>
<h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>这里简单介绍了几种常见的处理方法，实际使用中，一定还有更好地方法、或一些特殊的问题，欢迎大家分享、反馈。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;SQL笔试题&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;下面的SQL基于PostgreSQL&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;1-行转列&quot;&gt;&lt;a href=&quot;#1-行转列&quot; class=&quot;headerlink&quot; title=&quot;1. 行转列&quot;&gt;&lt;/a&gt;1. 行转列&lt;/h1&gt;&lt;h2 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h2&gt;&lt;p&gt;我们写SQL的时候，经常会遇到一些列转行、行转列的情况，有的时候是为了展现需要，有的时候是代码里就得这样转一下。总之嘞，得掌握这个技巧。下面就开始我们的练习。&lt;/p&gt;
&lt;h2 id=&quot;测试数据&quot;&gt;&lt;a href=&quot;#测试数据&quot; class=&quot;headerlink&quot; title=&quot;测试数据&quot;&gt;&lt;/a&gt;测试数据&lt;/h2&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt; interview.tm_score&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;(&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  stu_name &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;), &lt;span class=&quot;comment&quot;&gt;-- 学生名称&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  course_name &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;), &lt;span class=&quot;comment&quot;&gt;-- 课程名称&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  score &lt;span class=&quot;built_in&quot;&gt;numeric&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;-- 分数&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WITH&lt;/span&gt; (&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  OIDS=&lt;span class=&quot;literal&quot;&gt;FALSE&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 初始化数据&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; interview.tm_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;路飞&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; interview.tm_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;路飞&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;62&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; interview.tm_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;路飞&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; interview.tm_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;索隆&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; interview.tm_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;索隆&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; interview.tm_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;索隆&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; interview.tm_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;娜美&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;数学&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; interview.tm_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;娜美&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;语文&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;44&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; interview.tm_score &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;娜美&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;英语&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-02-01.png-blog.photo&quot; alt=&quot;data-analyst-interview-sql-02-01&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="笔试题" scheme="https://yuguiyang.github.io/categories/%E7%AC%94%E8%AF%95%E9%A2%98/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="笔试题" scheme="https://yuguiyang.github.io/tags/%E7%AC%94%E8%AF%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>SQL笔试题-累计值（月累计、年累计）</title>
    <link href="https://yuguiyang.github.io/2017/08/28/data-analyst-interview-sql-01/"/>
    <id>https://yuguiyang.github.io/2017/08/28/data-analyst-interview-sql-01/</id>
    <published>2017-08-28T03:11:00.000Z</published>
    <updated>2017-08-29T03:04:09.671Z</updated>
    
    <content type="html"><![CDATA[<p>SQL笔试题</p>
<blockquote>
<p>下面的SQL基于PostgreSQL</p>
</blockquote>
<h1 id="1-累计值（月累计、年累计）"><a href="#1-累计值（月累计、年累计）" class="headerlink" title="1. 累计值（月累计、年累计）"></a>1. 累计值（月累计、年累计）</h1><h2 id="背景描述"><a href="#背景描述" class="headerlink" title="背景描述"></a>背景描述</h2><p>比如说，我们有这样一份数据,记录的是图书每天的销量情况：</p>
<table>
<thead>
<tr>
<th>日期</th>
<th>图书名称</th>
<th>销量</th>
</tr>
</thead>
<tbody>
<tr>
<td>2017-01-01</td>
<td>解忧杂货店</td>
<td>90</td>
</tr>
<tr>
<td>2017-01-03</td>
<td>解忧杂货店</td>
<td>50</td>
</tr>
<tr>
<td>2017-01-05</td>
<td>解忧杂货店</td>
<td>100</td>
</tr>
<tr>
<td>2017-01-01</td>
<td>雪落香杉树</td>
<td>100</td>
</tr>
<tr>
<td>2017-01-03</td>
<td>雪落香杉树</td>
<td>44</td>
</tr>
<tr>
<td>2017-01-04</td>
<td>雪落香杉树</td>
<td>99</td>
</tr>
</tbody>
</table>
<p>现在，我们要统计每本书，当月的累计销量？即1号是1号的销量，2号是1号+2号当天的销量（注意：这里2号当天虽然没有销量，但是应该为1号的90+2号的0，为90）。大家先思考下，如果可以很快解答，就不需要接着读啦，有疑问的同学可以继续往下看。</p>
<h2 id="测试数据"><a href="#测试数据" class="headerlink" title="测试数据"></a>测试数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 图书的销量表</span></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> interview.tm_book_sales</div><div class="line">(</div><div class="line">  calendar_date <span class="built_in">date</span>, <span class="comment">-- 日期</span></div><div class="line">  book_name <span class="built_in">character</span> <span class="built_in">varying</span>(<span class="number">100</span>), <span class="comment">-- 图书名称</span></div><div class="line">  sales <span class="built_in">numeric</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="comment">-- 销量</span></div><div class="line">)</div><div class="line"><span class="keyword">WITH</span> (</div><div class="line">  OIDS=<span class="literal">FALSE</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">-- 测试数据</span></div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-01'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">56</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-02'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">100</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-03'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">70</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-06'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">11</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-07'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">65</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-08'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">9</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-09'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">30</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-10'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">56</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-01'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">18</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-02'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">40</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-03'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">2</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-04'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">22</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-05'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">48</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-07'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">71</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-09'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">73</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-01-10'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">37</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-03'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">5</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-05'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">46</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-06'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">35</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-07'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">10</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-09'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">30</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-10'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">12</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-13'</span>,<span class="string">'解忧杂货店'</span>,<span class="number">43</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-01'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">10</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-04'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">78</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-10'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">50</span>);</div><div class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tm_book_sales <span class="keyword">values</span>(<span class="string">'2017-02-20'</span>,<span class="string">'雪落香杉树'</span>,<span class="number">93</span>);</div></pre></td></tr></table></figure>
<p>现在呢，我们有了图书每天的销量数据，下面，我们思考1个问题：<br>我想要统计每本图书的当月累计销量，应该怎么做呢？</p>
<a id="more"></a>
<p>如果只是单纯的统计每本书每个月的销量，熟悉SQL的同学，一定可以很快想到<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	to_char(calendar_date,<span class="string">'yyyy-mm'</span>) month_name,</div><div class="line">	book_name,</div><div class="line">	<span class="keyword">sum</span>(sales) </div><div class="line"><span class="keyword">from</span> </div><div class="line">	interview.tm_book_sales </div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span></div><div class="line">	to_char(calendar_date,<span class="string">'yyyy-mm'</span>),</div><div class="line">	book_name</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	book_name,</div><div class="line">	to_char(calendar_date,<span class="string">'yyyy-mm'</span>)</div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-01-01.png-blog.photo" alt="data-analyst-interview-sql-01-01"></p>
<p>下面，我们来想下，这个月累计怎么做？<br>月累计值，其实就是当天的销量再加上当天之前的销量</p>
<h2 id="自关联"><a href="#自关联" class="headerlink" title="自关联"></a>自关联</h2><p>通过 interview.tm_book_sales 表，我们可以获取每一天的销量，那要怎样获取每天历史的销量呢？<br>最简单的方式就是自关联了。<br>其实就是自己和自己去关联，来获取历史的销量<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	t_today.calendar_date,</div><div class="line">	t_today.book_name,</div><div class="line">	<span class="keyword">sum</span>(t_his.sales) sales_mtd</div><div class="line"><span class="keyword">from</span> </div><div class="line">	interview.tm_book_sales t_today</div><div class="line"><span class="keyword">left</span> <span class="keyword">join</span> </div><div class="line">	interview.tm_book_sales t_his</div><div class="line"><span class="keyword">on</span></div><div class="line">	<span class="comment">-- 图书名称相等</span></div><div class="line">	t_his.book_name = t_today.book_name </div><div class="line"><span class="keyword">and</span> </div><div class="line">	<span class="comment">-- 月份相等，只统计当月</span></div><div class="line">	to_char(t_his.calendar_date,<span class="string">'yyyy-mm'</span>) = to_char(t_today.calendar_date,<span class="string">'yyyy-mm'</span>)</div><div class="line"><span class="keyword">and</span></div><div class="line">	<span class="comment">-- 获取当天之前的历史日期</span></div><div class="line">	t_his.calendar_date &lt;= t_today.calendar_date</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span></div><div class="line">	t_today.calendar_date,</div><div class="line">	t_today.book_name</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	t_today.book_name,</div><div class="line">	t_today.calendar_date</div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-01-02.png-blog.photo" alt="data-analyst-interview-sql-01-02"></p>
<p>好了，上面，我们通过自关联，获取了每本图书的月累计销量，不要太高兴，我们观察下，就会发现些问题。<br>我们看看日期，就会发现，有些日期是没有销量的，比如：《解忧杂货店》2017-01-04，2017-01-05 就没有销量，但实际上，如果是累计值得花，他是应该有数据的，因为1号、2号、3号都有数据，就算4号当天没有销量，月累计也应该要算上前3天的销量，所以我们的SQL并不严谨，还得修改。</p>
<h2 id="补全没有销量的日期"><a href="#补全没有销量的日期" class="headerlink" title="补全没有销量的日期"></a>补全没有销量的日期</h2><p>我们需要想办法补全缺失的日期，如果，t_today里面含有每一天每本书的数据就好了，这就要我们手动构造一个了。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> </div><div class="line">	t_day.calendar_date,</div><div class="line">	t_book.book_name</div><div class="line"><span class="keyword">from</span></div><div class="line">    <span class="comment">-- 日期维度表，就是存放每一天</span></div><div class="line">	base.dm_calendar t_day</div><div class="line"><span class="keyword">cross</span> <span class="keyword">join</span> </div><div class="line">    <span class="comment">-- 所有的图书信息</span></div><div class="line">	(<span class="keyword">select</span> <span class="keyword">distinct</span> book_name <span class="keyword">from</span> interview.tm_book_sales) t_book</div><div class="line"><span class="keyword">where</span> </div><div class="line">	t_day.month_id=<span class="number">201701</span></div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-01-03.png-blog.photo" alt="data-analyst-interview-sql-01-03"></p>
<p>日期维度表的话，其实是数仓中必备的地基础维度中的一个，她里面就是存放了每一天的数据，和其他一些我们会常用的字段，后面写一篇文章详细介绍下。<br>我们通过笛卡尔积，生成了一张包含每一天每本的图书的一个全维度表。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">with t_dim as (</div><div class="line">	<span class="keyword">select</span> </div><div class="line">		t_day.calendar_date,</div><div class="line">		t_book.book_name</div><div class="line">	<span class="keyword">from</span> </div><div class="line">		base.dm_calendar t_day</div><div class="line">	<span class="keyword">cross</span> <span class="keyword">join</span> </div><div class="line">		(<span class="keyword">select</span> <span class="keyword">distinct</span> book_name <span class="keyword">from</span> interview.tm_book_sales) t_book</div><div class="line">	<span class="keyword">where</span> </div><div class="line">		t_day.month_id=<span class="number">201701</span></div><div class="line">)</div><div class="line"><span class="keyword">select</span> </div><div class="line">	t_dim.calendar_date,</div><div class="line">	t_dim.book_name,</div><div class="line">	<span class="keyword">sum</span>(t_his.sales) sales_mtd</div><div class="line"><span class="keyword">from</span> </div><div class="line">	t_dim</div><div class="line"><span class="keyword">left</span> <span class="keyword">join</span> 	</div><div class="line">	interview.tm_book_sales t_today</div><div class="line"><span class="keyword">on</span> </div><div class="line">	t_today.calendar_date = t_dim.calendar_date</div><div class="line"><span class="keyword">and</span></div><div class="line">	t_today.book_name = t_dim.book_name</div><div class="line"><span class="keyword">left</span> <span class="keyword">join</span> </div><div class="line">	interview.tm_book_sales t_his</div><div class="line"><span class="keyword">on</span></div><div class="line">	<span class="comment">-- 图书名称相等</span></div><div class="line">	t_his.book_name = t_dim.book_name </div><div class="line"><span class="keyword">and</span> </div><div class="line">	<span class="comment">-- 月份相等，只统计当月</span></div><div class="line">	to_char(t_his.calendar_date,<span class="string">'yyyy-mm'</span>) = to_char(t_dim.calendar_date,<span class="string">'yyyy-mm'</span>)</div><div class="line"><span class="keyword">and</span></div><div class="line">	<span class="comment">-- 获取当天之前的历史日期</span></div><div class="line">	t_his.calendar_date &lt;= t_dim.calendar_date</div><div class="line"><span class="keyword">group</span> <span class="keyword">by</span></div><div class="line">	t_dim.calendar_date,</div><div class="line">	t_dim.book_name</div><div class="line"><span class="keyword">order</span> <span class="keyword">by</span> </div><div class="line">	t_dim.book_name,</div><div class="line">	t_dim.calendar_date</div><div class="line">;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/data-analyst-interview-sql-01-04.png-blog.photo" alt="data-analyst-interview-sql-01-04"></p>
<p>好啦，补全了日期信息后，我们的月累计算是完成了，手工。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>简单总结下，通过上面的例子，我们要掌握什么呢？<br>首先是对业务的理解，比如上面的月累计的统计方法；然后根据统计方法，使用SQL去实现，一步步完善；还有对日期维度表的一个综合使用。<br>年累计的实现也是一样的，同学们可以自行练习下，有问题可以反馈。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;SQL笔试题&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;下面的SQL基于PostgreSQL&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;1-累计值（月累计、年累计）&quot;&gt;&lt;a href=&quot;#1-累计值（月累计、年累计）&quot; class=&quot;headerlink&quot; title=&quot;1. 累计值（月累计、年累计）&quot;&gt;&lt;/a&gt;1. 累计值（月累计、年累计）&lt;/h1&gt;&lt;h2 id=&quot;背景描述&quot;&gt;&lt;a href=&quot;#背景描述&quot; class=&quot;headerlink&quot; title=&quot;背景描述&quot;&gt;&lt;/a&gt;背景描述&lt;/h2&gt;&lt;p&gt;比如说，我们有这样一份数据,记录的是图书每天的销量情况：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;日期&lt;/th&gt;
&lt;th&gt;图书名称&lt;/th&gt;
&lt;th&gt;销量&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;2017-01-01&lt;/td&gt;
&lt;td&gt;解忧杂货店&lt;/td&gt;
&lt;td&gt;90&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2017-01-03&lt;/td&gt;
&lt;td&gt;解忧杂货店&lt;/td&gt;
&lt;td&gt;50&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2017-01-05&lt;/td&gt;
&lt;td&gt;解忧杂货店&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2017-01-01&lt;/td&gt;
&lt;td&gt;雪落香杉树&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2017-01-03&lt;/td&gt;
&lt;td&gt;雪落香杉树&lt;/td&gt;
&lt;td&gt;44&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;2017-01-04&lt;/td&gt;
&lt;td&gt;雪落香杉树&lt;/td&gt;
&lt;td&gt;99&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;现在，我们要统计每本书，当月的累计销量？即1号是1号的销量，2号是1号+2号当天的销量（注意：这里2号当天虽然没有销量，但是应该为1号的90+2号的0，为90）。大家先思考下，如果可以很快解答，就不需要接着读啦，有疑问的同学可以继续往下看。&lt;/p&gt;
&lt;h2 id=&quot;测试数据&quot;&gt;&lt;a href=&quot;#测试数据&quot; class=&quot;headerlink&quot; title=&quot;测试数据&quot;&gt;&lt;/a&gt;测试数据&lt;/h2&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;12&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;13&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;14&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;15&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;16&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;17&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;18&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;19&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;20&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;21&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;22&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;23&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;24&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;25&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;26&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;27&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;28&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;29&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;30&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;31&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;32&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;33&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;34&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;35&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;36&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;37&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;38&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;39&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 图书的销量表&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt; interview.tm_book_sales&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;(&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  calendar_date &lt;span class=&quot;built_in&quot;&gt;date&lt;/span&gt;, &lt;span class=&quot;comment&quot;&gt;-- 日期&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  book_name &lt;span class=&quot;built_in&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;varying&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;), &lt;span class=&quot;comment&quot;&gt;-- 图书名称&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  sales &lt;span class=&quot;built_in&quot;&gt;numeric&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;comment&quot;&gt;-- 销量&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WITH&lt;/span&gt; (&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;  OIDS=&lt;span class=&quot;literal&quot;&gt;FALSE&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;-- 测试数据&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-01&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-02&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;100&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-03&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-06&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-07&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-08&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-09&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-10&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-01&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-02&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-03&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-04&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-05&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-07&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;71&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-09&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-01-10&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-03&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-05&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;46&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-06&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-07&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-09&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-10&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-13&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;解忧杂货店&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-01&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-04&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-10&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;insert&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;into&lt;/span&gt; tm_book_sales &lt;span class=&quot;keyword&quot;&gt;values&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;2017-02-20&#39;&lt;/span&gt;,&lt;span class=&quot;string&quot;&gt;&#39;雪落香杉树&#39;&lt;/span&gt;,&lt;span class=&quot;number&quot;&gt;93&lt;/span&gt;);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;现在呢，我们有了图书每天的销量数据，下面，我们思考1个问题：&lt;br&gt;我想要统计每本图书的当月累计销量，应该怎么做呢？&lt;/p&gt;
    
    </summary>
    
      <category term="笔试题" scheme="https://yuguiyang.github.io/categories/%E7%AC%94%E8%AF%95%E9%A2%98/"/>
    
    
      <category term="SQL" scheme="https://yuguiyang.github.io/tags/SQL/"/>
    
      <category term="笔试题" scheme="https://yuguiyang.github.io/tags/%E7%AC%94%E8%AF%95%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>matplotlib手册(9) - 绘制动画</title>
    <link href="https://yuguiyang.github.io/2017/08/17/matplotlib-base-flash-09/"/>
    <id>https://yuguiyang.github.io/2017/08/17/matplotlib-base-flash-09/</id>
    <published>2017-08-17T03:11:00.000Z</published>
    <updated>2017-08-31T05:00:22.933Z</updated>
    
    <content type="html"><![CDATA[<p>matplotlib手册(9)</p>
<blockquote>
<p>绘制动画 </p>
</blockquote>
<p>前面，我们介绍了很多绘图的方法，matplotlib不单单可以绘制静态的图，还可以制作动态的图，下面，我们就来学习下。</p>
<blockquote>
<p>我们主要参考matplotlib官网的例子<a href="http://matplotlib.org/api/animation_api.html" target="_blank" rel="external">http://matplotlib.org/api/animation_api.html</a></p>
</blockquote>
<p>创建动画最简单的方式，就是使用Animation的子类,就是下面的这2个</p>
<h1 id="1-FuncAnimation"><a href="#1-FuncAnimation" class="headerlink" title="1. FuncAnimation"></a>1. FuncAnimation</h1><p>函数介绍及主要参数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">matplotlib</span>.<span class="title">animation</span>.<span class="title">FuncAnimation</span><span class="params">(fig, func, frames=None, init_func=None, fargs=None, save_count=None, **kwargs)</span></span></div><div class="line"><span class="class"></span></div><div class="line"><span class="class"><span class="title">fig</span> :</span> matplotlib.figure.Figure</div><div class="line">func : callable</div><div class="line">frames : iterable, int, generator function, <span class="keyword">or</span> <span class="keyword">None</span>, optional</div><div class="line">init_func : callable, optional</div><div class="line">fargs : tuple <span class="keyword">or</span> <span class="keyword">None</span>, optional</div><div class="line">interval : number, optional</div><div class="line"></div><div class="line">repeat_delay : number, optional</div><div class="line">repeat : bool, optional</div></pre></td></tr></table></figure></p>
<a id="more"></a>
<p>小栗子<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="string">"""</span></div><div class="line"><span class="string">Created on Thu Aug 17 18:19:08 2017</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">@author: yuguiyang</span></div><div class="line"><span class="string">"""</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np  </div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt  </div><div class="line"><span class="keyword">import</span> matplotlib.animation <span class="keyword">as</span> animation </div><div class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime </div><div class="line">  </div><div class="line"></div><div class="line">fig,axes = plt.subplots()  </div><div class="line">axes.plot(np.random.rand(<span class="number">10</span>))  </div><div class="line"></div><div class="line"><span class="comment">#重新绘制图形</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_line</span><span class="params">(data)</span>:</span> </div><div class="line">    print(datetime.now(),<span class="string">'--'</span>,data)</div><div class="line">    <span class="comment">#清空当前轴</span></div><div class="line">    plt.cla()</div><div class="line">    <span class="comment">#重新绘图</span></div><div class="line">    axes.plot(np.random.rand(<span class="number">10</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#传入的fig中，调用update_line函数，将range(3)作为参数传给update_line，1秒调用一次</span></div><div class="line">ani = animation.FuncAnimation(fig, update_line, <span class="number">3</span>, interval=<span class="number">1000</span>)  </div><div class="line"></div><div class="line">plt.show()</div></pre></td></tr></table></figure></p>
<p>上面的代码，我们定义了一个函数update_line，他会清空axes，并重新绘图；<br>FuncAnimation会每个1秒调用一次这个函数<br><img src="http://7xl61k.com1.z0.glb.clouddn.com/matplotlib-base-flash-09-01.gif-blog.photo" alt="matplotlib-base-flash-09-01"></p>
<p>这里记录一个小问题，暂时还没有解决</p>
<h2 id="frames-参数的问题"><a href="#frames-参数的问题" class="headerlink" title="frames 参数的问题"></a>frames 参数的问题</h2><p>上面的例子里，我们给的是一个常量3，按照官方的介绍，是按照range(3),来一次传给函数的，但实际测试下来，发现他的调用会有问题。<br>我们看下上面的那个输出</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/matplotlib-base-flash-09-03.png-blog.photo" alt="matplotlib-base-flash-09-03"></p>
<hr>
<p>刚刚发现了导致这个问题的原因，注意看这个：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">init_func : callable, optional</div><div class="line"></div><div class="line">    A function used to draw a clear frame. If <span class="keyword">not</span> given, the results of drawing <span class="keyword">from</span> the first item <span class="keyword">in</span> the frames sequence will be used. This function will be called once before the first frame.</div></pre></td></tr></table></figure></p>
<p>上面，因为我们没有指定初始化函数，所以导致，会调用一次update_line，用它返回值作为初始状态，我们改下脚本再看<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'init'</span>)</div><div class="line">    <span class="comment">#清空当前轴</span></div><div class="line">    plt.cla()</div><div class="line">    </div><div class="line">ani = animation.FuncAnimation(fig, update_line, <span class="number">3</span>, repeat=<span class="keyword">False</span>, interval=<span class="number">3000</span>,init_func=init)</div></pre></td></tr></table></figure></p>
<p>这回输出就正常了，</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/matplotlib-base-flash-09-04.png-blog.photo" alt="matplotlib-base-flash-09-04"></p>
<h2 id="repeat、repeat-delay"><a href="#repeat、repeat-delay" class="headerlink" title="repeat、repeat_delay"></a>repeat、repeat_delay</h2><p>这2个参数一般会配合使用，repeat默认是true，所以上面的例子会一直循环下去，<br>如果我们改为false,第一次循环完之后就会停止。</p>
<h1 id="2-ArtistAnimation"><a href="#2-ArtistAnimation" class="headerlink" title="2. ArtistAnimation"></a>2. ArtistAnimation</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">matplotlib</span>.<span class="title">animation</span>.<span class="title">ArtistAnimation</span><span class="params">(fig, artists, *args, **kwargs)</span></span></div><div class="line"><span class="class"></span></div><div class="line"><span class="class"><span class="title">artists</span> :</span> list</div><div class="line"></div><div class="line">    Each list entry a collection of artists that represent what needs to be enabled on each frame. These will be disabled <span class="keyword">for</span> other frames.</div></pre></td></tr></table></figure>
<p>使用起来和上面的差不多，这里不会调用函数，而是传入一个list，<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np  </div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt  </div><div class="line"><span class="keyword">import</span> matplotlib.animation <span class="keyword">as</span> animation </div><div class="line">  </div><div class="line"></div><div class="line">fig,axes = plt.subplots()  </div><div class="line">    </div><div class="line">ims= []</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</div><div class="line">    ims.append(axes.plot(np.random.rand(<span class="number">10</span>)))</div><div class="line"></div><div class="line">im_ani = animation.ArtistAnimation(fig, ims, interval=<span class="number">1000</span>, repeat_delay=<span class="number">3000</span>,</div><div class="line">                                   blit=<span class="keyword">True</span>)</div><div class="line">print(ims)</div><div class="line">plt.show()</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/matplotlib-base-flash-09-05.gif-blog.photo" alt="matplotlib-base-flash-09-05"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;matplotlib手册(9)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;绘制动画 &lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;前面，我们介绍了很多绘图的方法，matplotlib不单单可以绘制静态的图，还可以制作动态的图，下面，我们就来学习下。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;我们主要参考matplotlib官网的例子&lt;a href=&quot;http://matplotlib.org/api/animation_api.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://matplotlib.org/api/animation_api.html&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;创建动画最简单的方式，就是使用Animation的子类,就是下面的这2个&lt;/p&gt;
&lt;h1 id=&quot;1-FuncAnimation&quot;&gt;&lt;a href=&quot;#1-FuncAnimation&quot; class=&quot;headerlink&quot; title=&quot;1. FuncAnimation&quot;&gt;&lt;/a&gt;1. FuncAnimation&lt;/h1&gt;&lt;p&gt;函数介绍及主要参数&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;matplotlib&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;animation&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;FuncAnimation&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(fig, func, frames=None, init_func=None, fargs=None, save_count=None, **kwargs)&lt;/span&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;title&quot;&gt;fig&lt;/span&gt; :&lt;/span&gt; matplotlib.figure.Figure&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;func : callable&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;frames : iterable, int, generator function, &lt;span class=&quot;keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;, optional&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;init_func : callable, optional&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;fargs : tuple &lt;span class=&quot;keyword&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;None&lt;/span&gt;, optional&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;interval : number, optional&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;repeat_delay : number, optional&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;repeat : bool, optional&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="数据可视化-Python&amp;R" scheme="https://yuguiyang.github.io/categories/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-Python-R/"/>
    
    
      <category term="Python" scheme="https://yuguiyang.github.io/tags/Python/"/>
    
      <category term="数据可视化" scheme="https://yuguiyang.github.io/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
      <category term="matplotlib" scheme="https://yuguiyang.github.io/tags/matplotlib/"/>
    
  </entry>
  
  <entry>
    <title>最新行政区信息获取</title>
    <link href="https://yuguiyang.github.io/2017/08/14/the-newest-area-info-01/"/>
    <id>https://yuguiyang.github.io/2017/08/14/the-newest-area-info-01/</id>
    <published>2017-08-14T13:59:00.000Z</published>
    <updated>2017-09-04T15:04:39.861Z</updated>
    
    <content type="html"><![CDATA[<p>这是之前记录的，这里顺便分享下。</p>
<p>之前想要获取官方的省市区的代码code，就找了下。</p>
<p>官方地址：<a href="http://www.stats.gov.cn/tjsj/tjbz/xzqhdm/" target="_blank" rel="external">http://www.stats.gov.cn/tjsj/tjbz/xzqhdm/</a></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/the-newest-area-info-01-01.png-blog.photo" alt="the-newest-area-info-01-01"></p>
<p>我们可以直接将数据复制到Excel中，简单处理下，导入到数据库中</p>
<p>里面会有换行，先去个重，然后trim一下，再分列就可以了</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/the-newest-area-info-01-02.png-blog.photo" alt="the-newest-area-info-01-02"></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/the-newest-area-info-01-03.png-blog.photo" alt="the-newest-area-info-01-03"></p>
<p>最后，我们可以将数据组织成我们想要的维度表格式</p>
<p>————–update at 2017-08-15</p>
<p>上面呢，我是直接在Excel里面生成insert脚本插入数据库的，但是目前的表使用起来应该不是很方便，这里我们改造下。</p>
<p>这个区域信息呢，是很常用的一张维度表，通常他可能会是这个样子的<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> base.dm_area</div><div class="line">(</div><div class="line">  area_id <span class="built_in">integer</span>,</div><div class="line">  area_name <span class="built_in">character</span> <span class="built_in">varying</span>(<span class="number">50</span>),</div><div class="line">  province_id <span class="built_in">integer</span>,</div><div class="line">  province_name <span class="built_in">character</span> <span class="built_in">varying</span>(<span class="number">50</span>),</div><div class="line">  city_id <span class="built_in">integer</span>,</div><div class="line">  city_name <span class="built_in">character</span> <span class="built_in">varying</span>(<span class="number">50</span>),</div><div class="line">  country_id <span class="built_in">integer</span>,</div><div class="line">  country_name <span class="built_in">character</span> <span class="built_in">varying</span>(<span class="number">50</span>),</div><div class="line">  flevel <span class="built_in">integer</span></div><div class="line">)</div><div class="line"><span class="keyword">WITH</span> (</div><div class="line">  OIDS=<span class="literal">FALSE</span></div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>这里我们就简单处理下，变成这种格式。</p>
<p>其实一开始的时候，我们可以通过数据的格式区分他是省份、城市、还是区县，下面我们用的是一个套路</p>
<p>主要是观察法，因为这个code都是有规律的，所以我们处理起来方便很多</p>
<p>code一共是6位，前两位是省份、中间2位是城市，后2位是区县<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span> public.b_area <span class="keyword">where</span> area_id||<span class="string">''</span> <span class="keyword">like</span> <span class="string">'00'</span></div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/the-newest-area-info-01-04.png-blog.photo" alt="the-newest-area-info-01-04"></p>
<p>下面，我们来初始化数据<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> base.dm_area(</div><div class="line">            area_id, area_name)</div><div class="line"><span class="keyword">select</span> *<span class="keyword">from</span>  public.b_area;      </div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">-- 初始化flevel 1:省份,2:城市,3:区县</span></div><div class="line"><span class="keyword">update</span> base.dm_area <span class="keyword">set</span> flevel=<span class="number">1</span> <span class="keyword">where</span> area_id||<span class="string">''</span> <span class="keyword">like</span> <span class="string">'00'</span>;</div><div class="line"><span class="keyword">update</span> base.dm_area <span class="keyword">set</span> flevel=<span class="number">2</span> <span class="keyword">where</span> area_id||<span class="string">''</span> <span class="keyword">like</span> <span class="string">''</span> <span class="keyword">and</span> flevel <span class="keyword">is</span> <span class="literal">null</span>;</div><div class="line"><span class="keyword">update</span> base.dm_area <span class="keyword">set</span> flevel=<span class="number">3</span> <span class="keyword">where</span> flevel <span class="keyword">is</span> <span class="literal">null</span>;</div><div class="line"></div><div class="line"><span class="comment">-- 更新省份信息</span></div><div class="line"><span class="keyword">update</span> base.dm_area a </div><div class="line"><span class="keyword">set</span> </div><div class="line">	province_id = b.area_id,</div><div class="line">	province_name = b.area_name</div><div class="line"><span class="keyword">from</span> </div><div class="line">	base.dm_area b</div><div class="line"><span class="keyword">where</span> </div><div class="line">	<span class="keyword">left</span>(a.area_id||<span class="string">''</span>,<span class="number">2</span>)=<span class="keyword">left</span>(b.area_id||<span class="string">''</span>,<span class="number">2</span>) <span class="keyword">and</span> b.flevel=<span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="comment">-- 更新城市信息</span></div><div class="line"><span class="keyword">update</span> base.dm_area a </div><div class="line"><span class="keyword">set</span> </div><div class="line">	city_id = c.area_id,</div><div class="line">	city_name = c.area_name	</div><div class="line"><span class="keyword">from</span> </div><div class="line">	base.dm_area c </div><div class="line"><span class="keyword">where</span> </div><div class="line">	<span class="keyword">left</span>(a.area_id||<span class="string">''</span>,<span class="number">4</span>)=<span class="keyword">left</span>(c.area_id||<span class="string">''</span>,<span class="number">4</span>) <span class="keyword">and</span> c.flevel=<span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="comment">-- 更新区县信息</span></div><div class="line"><span class="keyword">update</span> base.dm_area a </div><div class="line"><span class="keyword">set</span> </div><div class="line">	country_id = area_id,</div><div class="line">	country_name = area_name	</div><div class="line"><span class="keyword">where</span> </div><div class="line">	a.flevel=<span class="number">3</span>;</div></pre></td></tr></table></figure></p>
<p>到这里，flevel=3的数据已经没有问题了，再对省份、城市做些优化就行了<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 补全数据</span></div><div class="line"><span class="keyword">update</span> base.dm_area </div><div class="line"><span class="keyword">set</span> </div><div class="line">	city_id=-area_id,city_name=area_name||<span class="string">'XT'</span>,</div><div class="line">	country_id=-area_id,country_name=area_name||<span class="string">'XT'</span></div><div class="line"><span class="keyword">where</span></div><div class="line">	flevel=<span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="keyword">update</span> base.dm_area </div><div class="line"><span class="keyword">set</span> </div><div class="line">	country_id=-area_id,country_name=area_name||<span class="string">'XT'</span></div><div class="line"><span class="keyword">where</span></div><div class="line">	flevel=<span class="number">2</span>;</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/the-newest-area-info-01-05.png-blog.photo" alt="the-newest-area-info-01-05"></p>
<p>好了，我们就处理好这个区域维度了，正常使用的话，估计就用flevel=3的就够了</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这是之前记录的，这里顺便分享下。&lt;/p&gt;
&lt;p&gt;之前想要获取官方的省市区的代码code，就找了下。&lt;/p&gt;
&lt;p&gt;官方地址：&lt;a href=&quot;http://www.stats.gov.cn/tjsj/tjbz/xzqhdm/&quot; target=&quot;_blank&quot; rel=&quot;ex
    
    </summary>
    
      <category term="随笔" scheme="https://yuguiyang.github.io/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="随笔" scheme="https://yuguiyang.github.io/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>爬虫小实例学习篇-猫眼电影</title>
    <link href="https://yuguiyang.github.io/2017/08/09/crawler-demo-01/"/>
    <id>https://yuguiyang.github.io/2017/08/09/crawler-demo-01/</id>
    <published>2017-08-09T13:59:00.000Z</published>
    <updated>2017-09-04T16:40:29.153Z</updated>
    
    <content type="html"><![CDATA[<p>这里参考了论坛里一位同学分享的博客：<a href="https://ask.hellobi.com/blog/JiangYiXin/7660" target="_blank" rel="external">猫眼电影TOP100爬取练习</a>，感谢分享。</p>
<p>学习要从模仿开始，学习了上面的博客之后，自己做下练习，正好最近看了selenium，就用了这个。</p>
<p>原作者的正则用的太溜了，等后面有时间再研究下，这里就简单的使用CSS Selector来实现了。</p>
<p>原文代码很精彩，我这个代码就粗糙很多了，先来个初始版，后面再慢慢优化。</p>
<p>大体思路和<a href="https://ask.hellobi.com/blog/yuguiyang1990/9172" target="_blank" rel="external">Python基础（7）- Selenium使用</a>  里面的豆瓣读书例子差不多，</p>
<a id="more"></a>
<p>代码（2017-08-09版）<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> csv</div><div class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</div><div class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</div><div class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</div><div class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</div><div class="line"><span class="keyword">from</span> selenium.common.exceptions <span class="keyword">import</span> TimeoutException</div><div class="line"></div><div class="line"><span class="comment">#打开浏览器</span></div><div class="line">browser = webdriver.Firefox()</div><div class="line"><span class="comment">#设置等待时长，最长等待10s</span></div><div class="line">wait = WebDriverWait(browser,<span class="number">10</span>)</div><div class="line"></div><div class="line"><span class="comment">#定义电影排名</span></div><div class="line">comment_index = <span class="number">0</span></div><div class="line"></div><div class="line"><span class="comment">#定义一个movie</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Movie</span>:</span></div><div class="line">    </div><div class="line">    __movie_id = <span class="number">0</span></div><div class="line">    __movie_name = <span class="string">''</span></div><div class="line">    __movie_star = <span class="string">''</span></div><div class="line">    __movie_releasetime = <span class="string">''</span></div><div class="line">    __movie_score = <span class="string">''</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self , movie_id,movie_name,movie_star,movie_releasetime,movie_score)</span>:</span></div><div class="line">        self.__movie_id = movie_id</div><div class="line">        self.__movie_name = movie_name</div><div class="line">        self.__movie_star = movie_star</div><div class="line">        self.__movie_releasetime = movie_releasetime</div><div class="line">        self.__movie_score = movie_score</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(self)</span>:</span></div><div class="line">        print(<span class="string">'影片排名: '</span>, self.__movie_id)</div><div class="line">        print(<span class="string">'影片名称: '</span>, self.__movie_name)</div><div class="line">        print(self.__movie_star)</div><div class="line">        print(self.__movie_releasetime)</div><div class="line">        print(<span class="string">'影片评分'</span>, self.__movie_score)</div><div class="line">        print(<span class="string">''</span>)</div><div class="line">        </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">simple_list</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> [self.__movie_id, self.__movie_name, self.__movie_star, self.__movie_releasetime, self.__movie_score]</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">save2csv</span><span class="params">(movie_list)</span>:</span></div><div class="line">    <span class="keyword">with</span> open(<span class="string">'movie.csv'</span>, <span class="string">'a'</span>, newline=<span class="string">''</span>,encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> csvfile:</div><div class="line">        csv_writer = csv.writer(csvfile)</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> movie_list:</div><div class="line">            csv_writer.writerow(m.simple_list())</div><div class="line">    </div><div class="line">        csvfile.close()</div><div class="line">        </div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">    <span class="comment">#打开URL</span></div><div class="line">    browser.get(<span class="string">'http://maoyan.com/board/4'</span>)</div><div class="line">    </div><div class="line">    <span class="comment">#输出浏览器标题</span></div><div class="line">    print(<span class="string">'browser title: '</span>,browser.title)</div><div class="line">    </div><div class="line">    <span class="comment">#数据更新信息</span></div><div class="line">    p_update_info = wait.until(EC.presence_of_element_located((By.CSS_SELECTOR,<span class="string">'div.main p.update-time'</span>)))</div><div class="line">    print(<span class="string">'更新信息: '</span>,p_update_info.text)</div><div class="line">    </div><div class="line">    <span class="comment">#输出当前页信息</span></div><div class="line">    show_current_page()</div><div class="line">    </div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_current_page</span><span class="params">()</span>:</span></div><div class="line">    print(<span class="string">'-----------------------------------'</span>)</div><div class="line">    print(<span class="string">'current url: '</span>,browser.current_url)</div><div class="line">    </div><div class="line">    <span class="comment">#获取当前页信息</span></div><div class="line">    div_page = wait.until(EC.presence_of_element_located((By.CSS_SELECTOR,<span class="string">'div.pager-main li.active'</span>)))</div><div class="line">    print(<span class="string">'current page: '</span>,div_page.text)</div><div class="line">    </div><div class="line">    <span class="comment">#当前页总数量</span></div><div class="line">    div_items = wait.until(EC.presence_of_all_elements_located((By.CSS_SELECTOR,<span class="string">'div.main div.board-item-main div.board-item-content'</span>)))</div><div class="line">    print(<span class="string">'total count: '</span>,len(div_items))</div><div class="line">    </div><div class="line">    movie_list = []</div><div class="line">    <span class="comment">#结果集有很多结果，我们获取</span></div><div class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> div_items:</div><div class="line">        <span class="comment">#调用全局变量</span></div><div class="line">        <span class="keyword">global</span> comment_index</div><div class="line">        comment_index += <span class="number">1</span></div><div class="line">        </div><div class="line">        <span class="comment">#获取我们需要的信息</span></div><div class="line">        p_name = item.find_element_by_css_selector(<span class="string">'div.movie-item-info p.name'</span>)</div><div class="line">        </div><div class="line">        p_star = item.find_element_by_css_selector(<span class="string">'div.movie-item-info p.star'</span>)</div><div class="line">        </div><div class="line">        p_releasetime = item.find_element_by_css_selector(<span class="string">'div.movie-item-info p.releasetime'</span>)</div><div class="line">        </div><div class="line">        p_score_integer = item.find_element_by_css_selector(<span class="string">'div.movie-item-number p.score i.integer'</span>)</div><div class="line">        p_score_fraction = item.find_element_by_css_selector(<span class="string">'div.movie-item-number p.score i.fraction'</span>)</div><div class="line"></div><div class="line">        <span class="comment">#初始化movie对象</span></div><div class="line">        m = Movie(comment_index , p_name.text , p_star.text, p_releasetime.text, p_score_integer.text+p_score_fraction.text)</div><div class="line">        movie_list.append(m)</div><div class="line">    </div><div class="line">    save2csv(movie_list)</div><div class="line">    <span class="comment">#获取下一页</span></div><div class="line">    show_next_page()</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_next_page</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="comment">#获取下一页的标签</span></div><div class="line">        <span class="comment">#最后1页，没有下一页标签</span></div><div class="line">        a_next = wait.until(EC.presence_of_element_located((By.PARTIAL_LINK_TEXT,<span class="string">'下一页'</span>)))</div><div class="line">        a_next.click()</div><div class="line">        </div><div class="line">        show_current_page()</div><div class="line">    <span class="keyword">except</span> TimeoutException:</div><div class="line">        <span class="comment">#找不到下一页</span></div><div class="line">        print(<span class="string">'get all movies.'</span>)</div><div class="line">        <span class="comment">#也有可能真是网络异常</span></div><div class="line">    <span class="keyword">finally</span>:</div><div class="line">        browser.quit()</div><div class="line">        </div><div class="line">        </div><div class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure></p>
<p>这里就简单记录遇到的一些问题和后面需要优化的地方：</p>
<ol>
<li>获取影片信息的时候，数据没有清洗好，像这个“主演”，“上映时间”还没有剔除掉；那个地点也可以拆分出来单独一个字段</li>
</ol>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/crawler-demo-01-01.png-blog.photo" alt="crawler-demo-01-01"></p>
<ol>
<li><p>csv编码问题，一开始默认使用gbk（在Windows下开发的），会报错，说是有异常的字符无法保存，改为UTF-8后，就可以了，但是使用CSV打开前，先用notepad++转了编码，才用CSV打开</p>
</li>
<li><p>使用正则去获取元素</p>
</li>
</ol>
<p>4.异常问题的处理</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这里参考了论坛里一位同学分享的博客：&lt;a href=&quot;https://ask.hellobi.com/blog/JiangYiXin/7660&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;猫眼电影TOP100爬取练习&lt;/a&gt;，感谢分享。&lt;/p&gt;
&lt;p&gt;学习要从模仿开始，学习了上面的博客之后，自己做下练习，正好最近看了selenium，就用了这个。&lt;/p&gt;
&lt;p&gt;原作者的正则用的太溜了，等后面有时间再研究下，这里就简单的使用CSS Selector来实现了。&lt;/p&gt;
&lt;p&gt;原文代码很精彩，我这个代码就粗糙很多了，先来个初始版，后面再慢慢优化。&lt;/p&gt;
&lt;p&gt;大体思路和&lt;a href=&quot;https://ask.hellobi.com/blog/yuguiyang1990/9172&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Python基础（7）- Selenium使用&lt;/a&gt;  里面的豆瓣读书例子差不多，&lt;/p&gt;
    
    </summary>
    
      <category term="Python-爬虫" scheme="https://yuguiyang.github.io/categories/Python-%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="Python" scheme="https://yuguiyang.github.io/tags/Python/"/>
    
      <category term="爬虫" scheme="https://yuguiyang.github.io/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>numpy手册(1)-ndarray</title>
    <link href="https://yuguiyang.github.io/2017/08/02/numpy-handbook-01/"/>
    <id>https://yuguiyang.github.io/2017/08/02/numpy-handbook-01/</id>
    <published>2017-08-02T13:59:00.000Z</published>
    <updated>2017-08-27T15:17:55.671Z</updated>
    
    <content type="html"><![CDATA[<p>前面我们算是简单入门了Pandas，numpy也是数据分析中常用的，这里我们也来简单学习下。</p>
<h1 id="1-numpy基本介绍"><a href="#1-numpy基本介绍" class="headerlink" title="1.numpy基本介绍"></a>1.numpy基本介绍</h1><blockquote class="blockquote-center"><br>numpy是Python的一种开源数值计算扩展，这种工具可以用来存储和处理大型矩阵。<br>一个用Python实现的科学计算包。<br>from 百度百科<br></blockquote>

<p>numpy有2种基本对象，<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ndarray（N-dimensional array object）和 ufunc（universal function object）</div></pre></td></tr></table></figure></p>
<p>ndarray是存储单一数据类型的多维数组，ufunc是能够对数组进行处理的函数。</p>
<a id="more"></a>
<h1 id="2-ndarray"><a href="#2-ndarray" class="headerlink" title="2.ndarray"></a>2.ndarray</h1><p>我们先来看看这个数组<br>首先，我们得引入numpy<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div></pre></td></tr></table></figure></p>
<h2 id="2-1-创建"><a href="#2-1-创建" class="headerlink" title="2.1 创建"></a>2.1 创建</h2><p>数组初始化的话有很多方式：Array creation routines<br>我们可以直接使用list来初始化，array有很多的属性，比如大小，维度，元素个数<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"></div><div class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</div><div class="line">b = np.array([<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</div><div class="line">c = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])</div><div class="line"></div><div class="line">print(a,type(a),<span class="string">',shape:'</span>,a.shape,<span class="string">',ndim:'</span>,a.ndim,<span class="string">',size:'</span>,a.size)</div><div class="line">print(b,type(b),<span class="string">',shape:'</span>,b.shape,<span class="string">',ndim:'</span>,b.ndim,<span class="string">',size:'</span>,b.size)</div><div class="line">print(c,type(c),<span class="string">',shape:'</span>,c.shape,<span class="string">',ndim:'</span>,c.ndim,<span class="string">',size:'</span>,c.size)</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/numpy-handbook-01-01.png-blog.photo" alt="numpy-handbook-01-01"></p>
<p>这里呢，我们定义了一维数组和二维数组，比如c，是3行3列的2维数组，元素个数是9个<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">numpy.array(object, dtype=<span class="keyword">None</span>, copy=<span class="keyword">True</span>, order=<span class="string">'K'</span>, subok=<span class="keyword">False</span>, ndmin=<span class="number">0</span>)</div></pre></td></tr></table></figure></p>
<p>这里，我们再说下这个shape，这个属性可以修改<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#原来是4行3列</span></div><div class="line">c = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>],[<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>]])</div><div class="line">print(c)</div><div class="line"><span class="comment">#我们改为3行4列</span></div><div class="line">c.shape=(<span class="number">3</span>,<span class="number">4</span>)</div><div class="line">print(c)</div><div class="line"><span class="comment">#改为2行6列</span></div><div class="line">c.shape=(<span class="number">2</span>,<span class="number">6</span>)</div><div class="line">print(c)</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/numpy-handbook-01-02.png-blog.photo" alt="numpy-handbook-01-02"></p>
<p>这里需要注意下，如果某个轴的元素为-1，将根据数组元素的个数，自动计算长度<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">c.shape=(<span class="number">1</span>,<span class="number">-1</span>)</div><div class="line">print(c)</div><div class="line">c.shape=(<span class="number">-1</span>,<span class="number">1</span>)</div><div class="line">print(c)</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/numpy-handbook-01-03.png-blog.photo" alt="numpy-handbook-01-03"></p>
<p>这里的shape是改变原来的数组，另一个method，可以创建一个改变shape的新数组，而原数组保持不变<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">c = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>],[<span class="number">0</span>,<span class="number">0</span>,<span class="number">7</span>]])</div><div class="line">print(<span class="string">'c:'</span>,c)</div><div class="line">d = c.reshape(<span class="number">2</span>,<span class="number">6</span>)</div><div class="line">print(<span class="string">'c:'</span>,c)</div><div class="line">print(<span class="string">'d:'</span>,d)</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/numpy-handbook-01-04.png-blog.photo" alt="numpy-handbook-01-04"></p>
<p>这里要注意的是，c和d共享内存数据存储内存区域，c变了，d也会变<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">print(c[<span class="number">0</span>])</div><div class="line"><span class="comment">#修改c[0]</span></div><div class="line">c[<span class="number">0</span>]=[<span class="number">-9</span>,<span class="number">-8</span>,<span class="number">-3</span>]</div><div class="line">print(<span class="string">'c:'</span>,c)</div><div class="line">print(<span class="string">'d:'</span>,d)</div></pre></td></tr></table></figure></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/numpy-handbook-01-05.png-blog.photo" alt="numpy-handbook-01-05"></p>
<p>我们可以通过dtype来获取元素的类型，我们可以在初始化的时候，指定dtype<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">c = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</div><div class="line">print(c.dtype) <span class="comment">#int32</span></div><div class="line"></div><div class="line">d = np.array([<span class="number">1.1</span>,<span class="number">3.3</span>])</div><div class="line">print(d.dtype) <span class="comment">#float64</span></div></pre></td></tr></table></figure></p>
<p>下面，我们来看看常用的初始化方法</p>
<h3 id="arange"><a href="#arange" class="headerlink" title="arange"></a>arange</h3><p>通过指定开始值，结束值和步长来创建一维数组，这里不包过终值<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">arange([start,] stop[, step,], dtype=<span class="keyword">None</span>)</div><div class="line"></div><div class="line">np.arange(<span class="number">3</span>)</div><div class="line">Out[<span class="number">51</span>]: array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</div><div class="line"></div><div class="line">np.arange(<span class="number">1</span>,<span class="number">10</span>,<span class="number">3</span>)</div><div class="line">Out[<span class="number">52</span>]: array([<span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>])</div></pre></td></tr></table></figure></p>
<h3 id="linspace"><a href="#linspace" class="headerlink" title="linspace"></a>linspace</h3><p>通过指定开始值，终值和元素个数，来创建数组，这里包括终值<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">np.linspace(<span class="number">1</span>,<span class="number">10</span>,<span class="number">5</span>)</div><div class="line">Out[<span class="number">53</span>]: array([  <span class="number">1.</span>  ,   <span class="number">3.25</span>,   <span class="number">5.5</span> ,   <span class="number">7.75</span>,  <span class="number">10.</span>  ])</div><div class="line"></div><div class="line">np.linspace(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</div><div class="line">Out[<span class="number">54</span>]: array([ <span class="number">1.</span> ,  <span class="number">1.5</span>,  <span class="number">2.</span> ])</div></pre></td></tr></table></figure></p>
<h3 id="np-zeros-np-ones"><a href="#np-zeros-np-ones" class="headerlink" title="np.zeros,np.ones"></a>np.zeros,np.ones</h3><p>这2个函数可以初始化指定长度或形状的全0或全1的数组<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">np.ones(<span class="number">3</span>)</div><div class="line">Out[<span class="number">202</span>]: array([ <span class="number">1.</span>,  <span class="number">1.</span>,  <span class="number">1.</span>])</div><div class="line"></div><div class="line">np.ones([<span class="number">2</span>,<span class="number">2</span>])</div><div class="line">Out[<span class="number">203</span>]: </div><div class="line">array([[ <span class="number">1.</span>,  <span class="number">1.</span>],</div><div class="line">       [ <span class="number">1.</span>,  <span class="number">1.</span>]])</div><div class="line"></div><div class="line">np.zeros(<span class="number">5</span>)</div><div class="line">Out[<span class="number">204</span>]: array([ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>])</div><div class="line"></div><div class="line">np.zeros([<span class="number">4</span>,<span class="number">3</span>])</div><div class="line">Out[<span class="number">205</span>]: </div><div class="line">array([[ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>],</div><div class="line">       [ <span class="number">0.</span>,  <span class="number">0.</span>,  <span class="number">0.</span>]])</div></pre></td></tr></table></figure></p>
<h3 id="np-empty"><a href="#np-empty" class="headerlink" title="np.empty"></a>np.empty</h3><p>可以创建一个没有任何具体值得数组<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">np.empty(<span class="number">2</span>)</div><div class="line">Out[<span class="number">211</span>]: array([  <span class="number">7.74860419e-304</span>,   <span class="number">7.74860419e-304</span>])</div><div class="line"></div><div class="line">np.empty(<span class="number">2</span>,dtype=int)</div><div class="line">Out[<span class="number">214</span>]: array([        <span class="number">-1</span>, <span class="number">2147483647</span>])</div><div class="line"></div><div class="line">np.empty((<span class="number">3</span>,<span class="number">3</span>),dtype=np.float64)</div><div class="line">Out[<span class="number">215</span>]: </div><div class="line">array([[  <span class="number">4.94065646e-324</span>,   <span class="number">9.88131292e-324</span>,   <span class="number">1.48219694e-323</span>],</div><div class="line">       [  <span class="number">1.97626258e-323</span>,   <span class="number">2.47032823e-323</span>,   <span class="number">2.96439388e-323</span>],</div><div class="line">       [  <span class="number">3.45845952e-323</span>,   <span class="number">3.95252517e-323</span>,   <span class="number">4.44659081e-323</span>]])</div></pre></td></tr></table></figure></p>
<p>这要注意下，empty初始化的都是没有意思的值，不一定会初始化为0</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/numpy-handbook-01-06.png-blog.photo" alt="numpy-handbook-01-06"></p>
<h2 id="2-2-存取元素"><a href="#2-2-存取元素" class="headerlink" title="2.2 存取元素"></a>2.2 存取元素</h2><p>这里直接粘贴一个例子，原始教程在这：<a href="http://old.sebug.net/paper/books/scipydoc/numpy_intro.html" target="_blank" rel="external">http://old.sebug.net/paper/books/scipydoc/numpy_intro.html</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.arange(<span class="number">10</span>)</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">5</span>]    <span class="comment"># 用整数作为下标可以获取数组中的某个元素</span></div><div class="line"><span class="number">5</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">3</span>:<span class="number">5</span>]  <span class="comment"># 用范围作为下标获取数组的一个切片，包括a[3]不包括a[5]</span></div><div class="line">array([<span class="number">3</span>, <span class="number">4</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[:<span class="number">5</span>]   <span class="comment"># 省略开始下标，表示从a[0]开始</span></div><div class="line">array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[:<span class="number">-1</span>]  <span class="comment"># 下标可以使用负数，表示从数组后往前数</span></div><div class="line">array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">2</span>:<span class="number">4</span>] = <span class="number">100</span>,<span class="number">101</span>    <span class="comment"># 下标还可以用来修改元素的值</span></div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a</div><div class="line">array([  <span class="number">0</span>,   <span class="number">1</span>, <span class="number">100</span>, <span class="number">101</span>,   <span class="number">4</span>,   <span class="number">5</span>,   <span class="number">6</span>,   <span class="number">7</span>,   <span class="number">8</span>,   <span class="number">9</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">1</span>:<span class="number">-1</span>:<span class="number">2</span>]   <span class="comment"># 范围中的第三个参数表示步长，2表示隔一个元素取一个元素</span></div><div class="line">array([  <span class="number">1</span>, <span class="number">101</span>,   <span class="number">5</span>,   <span class="number">7</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[::<span class="number">-1</span>] <span class="comment"># 省略范围的开始下标和结束下标，步长为-1，整个数组头尾颠倒</span></div><div class="line">array([  <span class="number">9</span>,   <span class="number">8</span>,   <span class="number">7</span>,   <span class="number">6</span>,   <span class="number">5</span>,   <span class="number">4</span>, <span class="number">101</span>, <span class="number">100</span>,   <span class="number">1</span>,   <span class="number">0</span>])</div><div class="line"><span class="meta">&gt;&gt;&gt; </span>a[<span class="number">5</span>:<span class="number">1</span>:<span class="number">-2</span>] <span class="comment"># 步长为负数时，开始下标必须大于结束下标</span></div><div class="line">array([  <span class="number">5</span>, <span class="number">101</span>])</div></pre></td></tr></table></figure></p>
<p>就2维数组来说</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/numpy-handbook-01-07.png-blog.photo" alt="numpy-handbook-01-07"></p>
<p>这是基本的获取方式，还有些高级的方法</p>
<h3 id="使用整数序列"><a href="#使用整数序列" class="headerlink" title="使用整数序列"></a>使用整数序列</h3><p>这里简单来2个练习，原文例子很多，就是通过下标来筛选数据<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">a = np.arange(<span class="number">-5</span>,<span class="number">5</span>,<span class="number">1</span>)</div><div class="line"></div><div class="line">a</div><div class="line">Out[<span class="number">68</span>]: array([<span class="number">-5</span>, <span class="number">-4</span>, <span class="number">-3</span>, <span class="number">-2</span>, <span class="number">-1</span>,  <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>])</div><div class="line"></div><div class="line">a[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>]]</div><div class="line">Out[<span class="number">69</span>]: array([<span class="number">-4</span>, <span class="number">-2</span>,  <span class="number">0</span>])</div><div class="line"></div><div class="line"><span class="comment">### 使用布尔数组</span></div><div class="line"></div><div class="line">按照传入的布尔数组，只有为<span class="keyword">True</span>的才返回，也叫布尔型索引</div><div class="line">``` python</div><div class="line">a=np.array([<span class="number">-3</span>,<span class="number">1</span>,<span class="number">5</span>])</div><div class="line"></div><div class="line">a</div><div class="line">Out[<span class="number">72</span>]: array([<span class="number">-3</span>,  <span class="number">1</span>,  <span class="number">5</span>])</div><div class="line"></div><div class="line">a[[<span class="keyword">False</span>,<span class="keyword">True</span>,<span class="keyword">False</span>]]</div><div class="line">Out[<span class="number">73</span>]: array([<span class="number">1</span>])</div><div class="line"></div><div class="line">a[[<span class="keyword">True</span>,<span class="keyword">False</span>,<span class="keyword">True</span>]]</div><div class="line">Out[<span class="number">74</span>]: array([<span class="number">-3</span>,  <span class="number">5</span>])</div></pre></td></tr></table></figure></p>
<h1 id="3-附录（参考资料）"><a href="#3-附录（参考资料）" class="headerlink" title="3.附录（参考资料）"></a>3.附录（参考资料）</h1><p>文档：<br><a href="https://docs.scipy.org/doc/numpy-dev/reference/index.html#reference" target="_blank" rel="external">https://docs.scipy.org/doc/numpy-dev/reference/index.html#reference</a></p>
<p><a href="http://old.sebug.net/paper/books/scipydoc/numpy_intro.html" target="_blank" rel="external">numpy快速处理数据</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;前面我们算是简单入门了Pandas，numpy也是数据分析中常用的，这里我们也来简单学习下。&lt;/p&gt;
&lt;h1 id=&quot;1-numpy基本介绍&quot;&gt;&lt;a href=&quot;#1-numpy基本介绍&quot; class=&quot;headerlink&quot; title=&quot;1.numpy基本介绍&quot;&gt;&lt;/a&gt;1.numpy基本介绍&lt;/h1&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;numpy是Python的一种开源数值计算扩展，这种工具可以用来存储和处理大型矩阵。&lt;br&gt;一个用Python实现的科学计算包。&lt;br&gt;from 百度百科&lt;br&gt;&lt;/blockquote&gt;

&lt;p&gt;numpy有2种基本对象，&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;ndarray（N-dimensional array object）和 ufunc（universal function object）&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ndarray是存储单一数据类型的多维数组，ufunc是能够对数组进行处理的函数。&lt;/p&gt;
    
    </summary>
    
      <category term="Python-Numpy" scheme="https://yuguiyang.github.io/categories/Python-Numpy/"/>
    
    
      <category term="Python" scheme="https://yuguiyang.github.io/tags/Python/"/>
    
      <category term="Numpy" scheme="https://yuguiyang.github.io/tags/Numpy/"/>
    
  </entry>
  
  <entry>
    <title>Cognos资料汇总贴</title>
    <link href="https://yuguiyang.github.io/2017/08/01/cognos-doc-main/"/>
    <id>https://yuguiyang.github.io/2017/08/01/cognos-doc-main/</id>
    <published>2017-08-01T13:59:00.000Z</published>
    <updated>2017-08-27T14:52:03.630Z</updated>
    
    <content type="html"><![CDATA[<p>以前搞过Cognos，写过很多基础的教程，应该是14年的样子，都在CSDN上，这里贴个汇总贴吧，想要看的同学可以去看看，希望有帮助。</p>
<p>ReportStudio入门教程：<a href="http://blog.csdn.net/column/details/ygy-reportstudio.html" target="_blank" rel="external">http://blog.csdn.net/column/details/ygy-reportstudio.html</a></p>
<p>Framework Manage入门教程：<a href="http://blog.csdn.net/column/details/ygy-frameworkmanager.html" target="_blank" rel="external">http://blog.csdn.net/column/details/ygy-frameworkmanager.html</a></p>
<p>Cognos函数手册：<a href="http://blog.csdn.net/column/details/ygy-cognos-function.html" target="_blank" rel="external">http://blog.csdn.net/column/details/ygy-cognos-function.html</a></p>
<p>Cognos相关的其他资料（主页不同的类别下看看）：<a href="http://blog.csdn.net/yuguiyang1990" target="_blank" rel="external">http://blog.csdn.net/yuguiyang1990</a></p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/cognos-doc-main.png-blog.photo" alt="cognos-doc-main.png"></p>
<p>好了，感兴趣的同学，可以自行去看看，好久不搞了，估计有疑问也解决不了了…</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以前搞过Cognos，写过很多基础的教程，应该是14年的样子，都在CSDN上，这里贴个汇总贴吧，想要看的同学可以去看看，希望有帮助。&lt;/p&gt;
&lt;p&gt;ReportStudio入门教程：&lt;a href=&quot;http://blog.csdn.net/column/details/y
    
    </summary>
    
      <category term="数据可视化-Cognos" scheme="https://yuguiyang.github.io/categories/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96-Cognos/"/>
    
    
      <category term="数据可视化" scheme="https://yuguiyang.github.io/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
      <category term="Cognos" scheme="https://yuguiyang.github.io/tags/Cognos/"/>
    
  </entry>
  
  <entry>
    <title>小白学习Tableau-购物篮分析</title>
    <link href="https://yuguiyang.github.io/2017/08/01/Tableau-handbook-04/"/>
    <id>https://yuguiyang.github.io/2017/08/01/Tableau-handbook-04/</id>
    <published>2017-08-01T02:57:00.000Z</published>
    <updated>2017-09-01T02:47:22.351Z</updated>
    
    <content type="html"><![CDATA[<p>Tableau实例</p>
<blockquote>
<p>关于购物篮的介绍可以参考<a href="https://yuguiyang.github.io/2017/09/01/data-analyst-method-01/">数据分析案例-购物篮分析</a></p>
</blockquote>
<h1 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h1><p>我们想要分析的是顾客在购买商品的时候，哪些商品会同时购买。</p>
<p>下面，我们直接开始开发Tableau</p>
<h1 id="数据源"><a href="#数据源" class="headerlink" title="数据源"></a>数据源</h1><p>我们就是用Tableau默认自带的“示例-超市”</p>
<h1 id="拖入两张订单表"><a href="#拖入两张订单表" class="headerlink" title="拖入两张订单表"></a>拖入两张订单表</h1><p>因为我们需要分析的是每个顾客，在购买A商品的时候，还会购买哪些商品。只使用一张订单表，不是很容易看出来，所以我们需要拖入2张订单表，以此来更方便的处理数据。<br>因为我们要分析的是每个顾客，所以我们使用顾客ID去关联</p>
<a id="more"></a>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/Tableau-handbook-04-01.png-blog.photo" alt="Tableau-handbook-04-01"></p>
<h1 id="拖子类别进行分析"><a href="#拖子类别进行分析" class="headerlink" title="拖子类别进行分析"></a>拖子类别进行分析</h1><p>我们按照下图所示，进行拖拽<br><img src="http://7xl61k.com1.z0.glb.clouddn.com/Tableau-handbook-04-02.png-blog.photo" alt="Tableau-handbook-04-02"></p>
<h1 id="剔除无效的值"><a href="#剔除无效的值" class="headerlink" title="剔除无效的值"></a>剔除无效的值</h1><p>手工剔除，好麻烦，如果数据是在数据库中，直接用SQL处理掉就可以了</p>
<p><img src="http://7xl61k.com1.z0.glb.clouddn.com/Tableau-handbook-04-03.png-blog.photo" alt="Tableau-handbook-04-03"></p>
<p>这里，我们就快速的实现了购物篮分析，可以看到在购买某种商品时，同时购买其他商品的数量。</p>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a href="http://tableau.analyticservice.net/%E4%BA%BA%E4%BA%BA%E9%83%BD%E6%98%AF%E5%8F%AF%E8%A7%86%E5%8C%96%E5%88%86%E6%9E%90%E5%B8%88%E7%B3%BB%E5%88%97%EF%BC%9A%E7%94%A8tableau%E7%8E%A9%E8%BD%AC%E8%B4%AD%E7%89%A9%E7%AF%AE%E5%88%86%E6%9E%90/" target="_blank" rel="external">人人都是可视化分析师系列：用Tableau玩转购物篮分析</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Tableau实例&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;关于购物篮的介绍可以参考&lt;a href=&quot;https://yuguiyang.github.io/2017/09/01/data-analyst-method-01/&quot;&gt;数据分析案例-购物篮分析&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&quot;目标&quot;&gt;&lt;a href=&quot;#目标&quot; class=&quot;headerlink&quot; title=&quot;目标&quot;&gt;&lt;/a&gt;目标&lt;/h1&gt;&lt;p&gt;我们想要分析的是顾客在购买商品的时候，哪些商品会同时购买。&lt;/p&gt;
&lt;p&gt;下面，我们直接开始开发Tableau&lt;/p&gt;
&lt;h1 id=&quot;数据源&quot;&gt;&lt;a href=&quot;#数据源&quot; class=&quot;headerlink&quot; title=&quot;数据源&quot;&gt;&lt;/a&gt;数据源&lt;/h1&gt;&lt;p&gt;我们就是用Tableau默认自带的“示例-超市”&lt;/p&gt;
&lt;h1 id=&quot;拖入两张订单表&quot;&gt;&lt;a href=&quot;#拖入两张订单表&quot; class=&quot;headerlink&quot; title=&quot;拖入两张订单表&quot;&gt;&lt;/a&gt;拖入两张订单表&lt;/h1&gt;&lt;p&gt;因为我们需要分析的是每个顾客，在购买A商品的时候，还会购买哪些商品。只使用一张订单表，不是很容易看出来，所以我们需要拖入2张订单表，以此来更方便的处理数据。&lt;br&gt;因为我们要分析的是每个顾客，所以我们使用顾客ID去关联&lt;/p&gt;
    
    </summary>
    
      <category term="Tableau" scheme="https://yuguiyang.github.io/categories/Tableau/"/>
    
    
      <category term="数据可视化" scheme="https://yuguiyang.github.io/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/"/>
    
      <category term="Tableau" scheme="https://yuguiyang.github.io/tags/Tableau/"/>
    
  </entry>
  
</feed>
